import{d as we,M as Ce,r as k,g as Ne,a0 as Te,a as s,j as J,c as F,o as d,k as I,b as l,q as y,v as xe,N as n,w as e,l as Ie,F as E,s as L,m as r,f as o,a1 as W,a2 as X,e as f,t as Q,Y as Ue}from"./index-a6CENfl-.js";import{l as Z,g as Se,d as he,u as Fe,a as qe}from"./menu-BWwOmEC4.js";import{I as Me}from"./index-CTY1xO-l.js";const Re={class:"app-container"},Pe={class:"dialog-footer"},$e=we({name:"Menu"}),Le=Object.assign($e,{setup(De){const{proxy:_}=Ce(),{sys_show_hide:ee,sys_normal_disable:q}=_.useDict("sys_show_hide","sys_normal_disable"),j=k([]),w=k(!1),M=k(!0),S=k(!0),R=k(""),P=k([]),$=k(!1),D=k(!0),K=k(null),le=Ne({form:{},queryParams:{menuName:void 0,visible:void 0},rules:{menuName:[{required:!0,message:"菜单名称不能为空",trigger:"blur"}],orderNum:[{required:!0,message:"菜单顺序不能为空",trigger:"blur"}],path:[{required:!0,message:"路由地址不能为空",trigger:"blur"}]}}),{queryParams:T,form:u,rules:te}=Te(le);function x(){M.value=!0,Z(T.value).then(m=>{j.value=_.handleTree(m.data,"menuId"),M.value=!1})}function O(){P.value=[],Z().then(m=>{const t={menuId:0,menuName:"主类目",children:[]};t.children=_.handleTree(m.data,"menuId"),P.value.push(t)})}function ne(){w.value=!1,B()}function B(){u.value={menuId:void 0,parentId:0,menuName:void 0,icon:void 0,menuType:"M",orderNum:void 0,isFrame:"1",isCache:"0",visible:"0",status:"0"},_.resetForm("menuRef")}function ae(){K.value.reset()}function ue(m){u.value.icon=m}function A(){x()}function oe(){_.resetForm("queryRef"),A()}function z(m){B(),O(),m!=null&&m.menuId?u.value.parentId=m.menuId:u.value.parentId=0,w.value=!0,R.value="添加菜单"}function de(){D.value=!1,$.value=!$.value,Ue(()=>{D.value=!0})}async function se(m){B(),await O(),Se(m.menuId).then(t=>{u.value=t.data,w.value=!0,R.value="修改菜单"})}function re(){_.$refs.menuRef.validate(m=>{m&&(u.value.menuId!=null?Fe(u.value).then(t=>{_.$modal.msgSuccess("修改成功"),w.value=!1,x()}):qe(u.value).then(t=>{_.$modal.msgSuccess("新增成功"),w.value=!1,x()}))})}function me(m){_.$modal.confirm('是否确认删除名称为"'+m.menuName+'"的数据项?').then(function(){return he(m.menuId)}).then(()=>{x(),_.$modal.msgSuccess("删除成功")}).catch(()=>{})}return x(),(m,t)=>{const C=s("el-input"),p=s("el-form-item"),pe=s("el-option"),ie=s("el-select"),c=s("el-button"),Y=s("el-form"),i=s("el-col"),fe=s("right-toolbar"),G=s("el-row"),N=s("el-table-column"),_e=s("dict-tag"),ve=s("el-table"),ye=s("el-tree-select"),b=s("el-radio"),U=s("el-radio-group"),ce=s("search"),v=s("el-icon"),be=s("el-popover"),Ve=s("el-input-number"),V=s("question-filled"),g=s("el-tooltip"),ge=s("el-dialog"),h=J("hasPermi"),ke=J("loading");return d(),F("div",Re,[I(l(Y,{model:n(T),ref:"queryRef",inline:!0},{default:e(()=>[l(p,{label:"菜单名称",prop:"menuName"},{default:e(()=>[l(C,{modelValue:n(T).menuName,"onUpdate:modelValue":t[0]||(t[0]=a=>n(T).menuName=a),placeholder:"请输入菜单名称",clearable:"",style:{width:"200px"},onKeyup:Ie(A,["enter"])},null,8,["modelValue"])]),_:1}),l(p,{label:"状态",prop:"status"},{default:e(()=>[l(ie,{modelValue:n(T).status,"onUpdate:modelValue":t[1]||(t[1]=a=>n(T).status=a),placeholder:"菜单状态",clearable:"",style:{width:"200px"}},{default:e(()=>[(d(!0),F(E,null,L(n(q),a=>(d(),r(pe,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(p,null,{default:e(()=>[l(c,{type:"primary",icon:"Search",onClick:A},{default:e(()=>t[18]||(t[18]=[o("搜索")])),_:1,__:[18]}),l(c,{icon:"Refresh",onClick:oe},{default:e(()=>t[19]||(t[19]=[o("重置")])),_:1,__:[19]})]),_:1})]),_:1},8,["model"]),[[xe,n(S)]]),l(G,{gutter:10,class:"mb8"},{default:e(()=>[l(i,{span:1.5},{default:e(()=>[I((d(),r(c,{type:"primary",plain:"",icon:"Plus",onClick:z},{default:e(()=>t[20]||(t[20]=[o("新增")])),_:1,__:[20]})),[[h,["system:menu:add"]]])]),_:1}),l(i,{span:1.5},{default:e(()=>[l(c,{type:"info",plain:"",icon:"Sort",onClick:de},{default:e(()=>t[21]||(t[21]=[o("展开/折叠")])),_:1,__:[21]})]),_:1}),l(fe,{showSearch:n(S),"onUpdate:showSearch":t[2]||(t[2]=a=>W(S)?S.value=a:null),onQueryTable:x},null,8,["showSearch"])]),_:1}),n(D)?I((d(),r(ve,{key:0,data:n(j),"row-key":"menuId","default-expand-all":n($),"tree-props":{children:"children",hasChildren:"hasChildren"}},{default:e(()=>[l(N,{prop:"menuName",label:"菜单名称","show-overflow-tooltip":!0,width:"160"}),l(N,{prop:"icon",label:"图标",align:"center",width:"100"},{default:e(a=>[l(n(X),{"icon-class":a.row.icon},null,8,["icon-class"])]),_:1}),l(N,{prop:"orderNum",label:"排序",width:"60"}),l(N,{prop:"perms",label:"权限标识","show-overflow-tooltip":!0}),l(N,{prop:"component",label:"组件路径","show-overflow-tooltip":!0}),l(N,{prop:"status",label:"状态",width:"80"},{default:e(a=>[l(_e,{options:n(q),value:a.row.status},null,8,["options","value"])]),_:1}),l(N,{label:"创建时间",align:"center",width:"160",prop:"createTime"},{default:e(a=>[f("span",null,Q(m.parseTime(a.row.createTime)),1)]),_:1}),l(N,{label:"操作",align:"center",width:"210","class-name":"small-padding fixed-width"},{default:e(a=>[I((d(),r(c,{link:"",type:"primary",icon:"Edit",onClick:H=>se(a.row)},{default:e(()=>t[22]||(t[22]=[o("修改")])),_:2,__:[22]},1032,["onClick"])),[[h,["system:menu:edit"]]]),I((d(),r(c,{link:"",type:"primary",icon:"Plus",onClick:H=>z(a.row)},{default:e(()=>t[23]||(t[23]=[o("新增")])),_:2,__:[23]},1032,["onClick"])),[[h,["system:menu:add"]]]),I((d(),r(c,{link:"",type:"primary",icon:"Delete",onClick:H=>me(a.row)},{default:e(()=>t[24]||(t[24]=[o("删除")])),_:2,__:[24]},1032,["onClick"])),[[h,["system:menu:remove"]]])]),_:1})]),_:1},8,["data","default-expand-all"])),[[ke,n(M)]]):y("",!0),l(ge,{title:n(R),modelValue:n(w),"onUpdate:modelValue":t[17]||(t[17]=a=>W(w)?w.value=a:null),width:"680px","append-to-body":""},{footer:e(()=>[f("div",Pe,[l(c,{type:"primary",onClick:re},{default:e(()=>t[41]||(t[41]=[o("确 定")])),_:1,__:[41]}),l(c,{onClick:ne},{default:e(()=>t[42]||(t[42]=[o("取 消")])),_:1,__:[42]})])]),default:e(()=>[l(Y,{ref:"menuRef",model:n(u),rules:n(te),"label-width":"100px"},{default:e(()=>[l(G,null,{default:e(()=>[l(i,{span:24},{default:e(()=>[l(p,{label:"上级菜单"},{default:e(()=>[l(ye,{modelValue:n(u).parentId,"onUpdate:modelValue":t[3]||(t[3]=a=>n(u).parentId=a),data:n(P),props:{value:"menuId",label:"menuName",children:"children"},"value-key":"menuId",placeholder:"选择上级菜单","check-strictly":""},null,8,["modelValue","data"])]),_:1})]),_:1}),l(i,{span:24},{default:e(()=>[l(p,{label:"菜单类型",prop:"menuType"},{default:e(()=>[l(U,{modelValue:n(u).menuType,"onUpdate:modelValue":t[4]||(t[4]=a=>n(u).menuType=a)},{default:e(()=>[l(b,{value:"M"},{default:e(()=>t[25]||(t[25]=[o("目录")])),_:1,__:[25]}),l(b,{value:"C"},{default:e(()=>t[26]||(t[26]=[o("菜单")])),_:1,__:[26]}),l(b,{value:"F"},{default:e(()=>t[27]||(t[27]=[o("按钮")])),_:1,__:[27]})]),_:1},8,["modelValue"])]),_:1})]),_:1}),n(u).menuType!="F"?(d(),r(i,{key:0,span:12},{default:e(()=>[l(p,{label:"菜单图标",prop:"icon"},{default:e(()=>[l(be,{placement:"bottom-start",width:540,trigger:"click"},{reference:e(()=>[l(C,{modelValue:n(u).icon,"onUpdate:modelValue":t[5]||(t[5]=a=>n(u).icon=a),placeholder:"点击选择图标",onBlur:ae,readonly:""},{prefix:e(()=>[n(u).icon?(d(),r(n(X),{key:0,"icon-class":n(u).icon,class:"el-input__icon",style:{height:"32px",width:"16px"}},null,8,["icon-class"])):(d(),r(v,{key:1,style:{height:"32px",width:"16px"}},{default:e(()=>[l(ce)]),_:1}))]),_:1},8,["modelValue"])]),default:e(()=>[l(n(Me),{ref_key:"iconSelectRef",ref:K,onSelected:ue,"active-icon":n(u).icon},null,8,["active-icon"])]),_:1})]),_:1})]),_:1})):y("",!0),l(i,{span:12},{default:e(()=>[l(p,{label:"显示排序",prop:"orderNum"},{default:e(()=>[l(Ve,{modelValue:n(u).orderNum,"onUpdate:modelValue":t[6]||(t[6]=a=>n(u).orderNum=a),"controls-position":"right",min:0},null,8,["modelValue"])]),_:1})]),_:1}),l(i,{span:12},{default:e(()=>[l(p,{label:"菜单名称",prop:"menuName"},{default:e(()=>[l(C,{modelValue:n(u).menuName,"onUpdate:modelValue":t[7]||(t[7]=a=>n(u).menuName=a),placeholder:"请输入菜单名称"},null,8,["modelValue"])]),_:1})]),_:1}),n(u).menuType=="C"?(d(),r(i,{key:1,span:12},{default:e(()=>[l(p,{prop:"routeName"},{label:e(()=>[f("span",null,[l(g,{content:"默认不填则和路由地址相同：如地址为：`user`，则名称为`User`（注意：因为router会删除名称相同路由，为避免名字的冲突，特殊情况下请自定义，保证唯一性）",placement:"top"},{default:e(()=>[l(v,null,{default:e(()=>[l(V)]),_:1})]),_:1}),t[28]||(t[28]=o(" 路由名称 "))])]),default:e(()=>[l(C,{modelValue:n(u).routeName,"onUpdate:modelValue":t[8]||(t[8]=a=>n(u).routeName=a),placeholder:"请输入路由名称"},null,8,["modelValue"])]),_:1})]),_:1})):y("",!0),n(u).menuType!="F"?(d(),r(i,{key:2,span:12},{default:e(()=>[l(p,null,{label:e(()=>[f("span",null,[l(g,{content:"选择是外链则路由地址需要以`http(s)://`开头",placement:"top"},{default:e(()=>[l(v,null,{default:e(()=>[l(V)]),_:1})]),_:1}),t[29]||(t[29]=o("是否外链 "))])]),default:e(()=>[l(U,{modelValue:n(u).isFrame,"onUpdate:modelValue":t[9]||(t[9]=a=>n(u).isFrame=a)},{default:e(()=>[l(b,{value:"0"},{default:e(()=>t[30]||(t[30]=[o("是")])),_:1,__:[30]}),l(b,{value:"1"},{default:e(()=>t[31]||(t[31]=[o("否")])),_:1,__:[31]})]),_:1},8,["modelValue"])]),_:1})]),_:1})):y("",!0),n(u).menuType!="F"?(d(),r(i,{key:3,span:12},{default:e(()=>[l(p,{prop:"path"},{label:e(()=>[f("span",null,[l(g,{content:"访问的路由地址，如：`user`，如外网地址需内链访问则以`http(s)://`开头",placement:"top"},{default:e(()=>[l(v,null,{default:e(()=>[l(V)]),_:1})]),_:1}),t[32]||(t[32]=o(" 路由地址 "))])]),default:e(()=>[l(C,{modelValue:n(u).path,"onUpdate:modelValue":t[10]||(t[10]=a=>n(u).path=a),placeholder:"请输入路由地址"},null,8,["modelValue"])]),_:1})]),_:1})):y("",!0),n(u).menuType=="C"?(d(),r(i,{key:4,span:12},{default:e(()=>[l(p,{prop:"component"},{label:e(()=>[f("span",null,[l(g,{content:"访问的组件路径，如：`system/user/index`，默认在`views`目录下",placement:"top"},{default:e(()=>[l(v,null,{default:e(()=>[l(V)]),_:1})]),_:1}),t[33]||(t[33]=o(" 组件路径 "))])]),default:e(()=>[l(C,{modelValue:n(u).component,"onUpdate:modelValue":t[11]||(t[11]=a=>n(u).component=a),placeholder:"请输入组件路径"},null,8,["modelValue"])]),_:1})]),_:1})):y("",!0),n(u).menuType!="M"?(d(),r(i,{key:5,span:12},{default:e(()=>[l(p,null,{label:e(()=>[f("span",null,[l(g,{content:"控制器中定义的权限字符，如：@PreAuthorize(`@ss.hasPermi('system:user:list')`)",placement:"top"},{default:e(()=>[l(v,null,{default:e(()=>[l(V)]),_:1})]),_:1}),t[34]||(t[34]=o(" 权限字符 "))])]),default:e(()=>[l(C,{modelValue:n(u).perms,"onUpdate:modelValue":t[12]||(t[12]=a=>n(u).perms=a),placeholder:"请输入权限标识",maxlength:"100"},null,8,["modelValue"])]),_:1})]),_:1})):y("",!0),n(u).menuType=="C"?(d(),r(i,{key:6,span:12},{default:e(()=>[l(p,null,{label:e(()=>[f("span",null,[l(g,{content:'访问路由的默认传递参数，如：`{"id": 1, "name": "ry"}`',placement:"top"},{default:e(()=>[l(v,null,{default:e(()=>[l(V)]),_:1})]),_:1}),t[35]||(t[35]=o(" 路由参数 "))])]),default:e(()=>[l(C,{modelValue:n(u).query,"onUpdate:modelValue":t[13]||(t[13]=a=>n(u).query=a),placeholder:"请输入路由参数",maxlength:"255"},null,8,["modelValue"])]),_:1})]),_:1})):y("",!0),n(u).menuType=="C"?(d(),r(i,{key:7,span:12},{default:e(()=>[l(p,null,{label:e(()=>[f("span",null,[l(g,{content:"选择是则会被`keep-alive`缓存，需要匹配组件的`name`和地址保持一致",placement:"top"},{default:e(()=>[l(v,null,{default:e(()=>[l(V)]),_:1})]),_:1}),t[36]||(t[36]=o(" 是否缓存 "))])]),default:e(()=>[l(U,{modelValue:n(u).isCache,"onUpdate:modelValue":t[14]||(t[14]=a=>n(u).isCache=a)},{default:e(()=>[l(b,{value:"0"},{default:e(()=>t[37]||(t[37]=[o("缓存")])),_:1,__:[37]}),l(b,{value:"1"},{default:e(()=>t[38]||(t[38]=[o("不缓存")])),_:1,__:[38]})]),_:1},8,["modelValue"])]),_:1})]),_:1})):y("",!0),n(u).menuType!="F"?(d(),r(i,{key:8,span:12},{default:e(()=>[l(p,null,{label:e(()=>[f("span",null,[l(g,{content:"选择隐藏则路由将不会出现在侧边栏，但仍然可以访问",placement:"top"},{default:e(()=>[l(v,null,{default:e(()=>[l(V)]),_:1})]),_:1}),t[39]||(t[39]=o(" 显示状态 "))])]),default:e(()=>[l(U,{modelValue:n(u).visible,"onUpdate:modelValue":t[15]||(t[15]=a=>n(u).visible=a)},{default:e(()=>[(d(!0),F(E,null,L(n(ee),a=>(d(),r(b,{key:a.value,value:a.value},{default:e(()=>[o(Q(a.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})):y("",!0),l(i,{span:12},{default:e(()=>[l(p,null,{label:e(()=>[f("span",null,[l(g,{content:"选择停用则路由将不会出现在侧边栏，也不能被访问",placement:"top"},{default:e(()=>[l(v,null,{default:e(()=>[l(V)]),_:1})]),_:1}),t[40]||(t[40]=o(" 菜单状态 "))])]),default:e(()=>[l(U,{modelValue:n(u).status,"onUpdate:modelValue":t[16]||(t[16]=a=>n(u).status=a)},{default:e(()=>[(d(!0),F(E,null,L(n(q),a=>(d(),r(b,{key:a.value,value:a.value},{default:e(()=>[o(Q(a.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Le as default};
