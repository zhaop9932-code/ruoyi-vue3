import{_ as ne,r as p,g as D,a as d,c as u,o as i,b as t,w as s,e as l,q as P,f as n,N as V,ay as ie,t as a,az as H,aA as ae,F as k,s as z,m as K,aB as ue,aC as re}from"./index-kbfDsxmo.js";/* empty css                                                                     */const de={class:"ai-assist"},pe={class:"card-header"},_e={class:"ai-function-section"},ce={class:"ai-action-buttons"},me={key:0,class:"generated-result"},fe={class:"result-header"},ve={class:"result-content"},ge={class:"result-item"},ye={class:"result-item"},be={class:"result-item"},xe={class:"result-item"},Ve={class:"result-item"},ke={class:"ai-function-section"},ze={class:"ai-action-buttons"},we={key:0,class:"generated-result"},Ie={class:"result-header"},Ne={class:"result-content"},Ce={class:"result-item"},Te={class:"result-item"},Re={class:"result-item"},Ee={class:"optimize-suggestions"},Ae={class:"result-item"},De={class:"ai-function-section"},Pe={class:"ai-action-buttons"},Ue={key:0,class:"generated-result"},qe={class:"result-header"},Fe={class:"result-content"},Me={key:0,class:"conflict-result"},Se={class:"result-item"},Be={class:"conflict-description"},Oe={class:"conflict-rules"},Ge={class:"conflict-solution"},Je={key:1,class:"no-conflict-result"},Le={class:"ai-function-section"},$e={class:"ai-action-buttons"},je={key:0,class:"generated-result"},He={class:"result-content"},Ke={class:"result-item"},Qe={class:"result-item"},We={class:"rule-explanation"},Xe={class:"result-item"},Ye={class:"result-item"},Ze={class:"applicable-scenarios"},he={__name:"RuleAIAssist",emits:["generate-rule","optimize-rule","detect-conflicts"],setup(el,{emit:Q}){const G=Q,J=p("generate"),v=D({description:"",ruleType:"condition"}),g=D({expression:"",optimizeDirections:["性能优化","逻辑优化","可读性优化"]}),C=D({ruleIds:[]}),T=D({expression:""}),U=p(!1),q=p(!1),F=p(!1),M=p(!1),_=p(null),m=p(null),f=p(null),w=p(null),L=p([{ruleId:1,ruleName:"重量验证规则"},{ruleId:2,ruleName:"总价计算规则"},{ruleId:3,ruleName:"颜色折扣规则"},{ruleId:4,ruleName:"库存验证规则"}]),W=async()=>{if(v.description){U.value=!0;try{await new Promise(r=>setTimeout(r,1500)),_.value={ruleName:"AI生成的产品折扣规则",ruleType:v.ruleType,conditions:[{id:1,type:"number",field:"productPrice",operator:">",value:1e3,logic:""},{id:2,type:"boolean",field:"isVip",operator:"=",value:!0,logic:"AND"}],actions:[{id:1,type:"setProperty",field:"discount",value:.1,condition:"",sequence:1}],ruleExpression:"if (productPrice > 1000 AND isVip) { discount = 0.1 }"}}catch(r){console.error("生成规则失败:",r),ElMessage.error("生成规则失败，请稍后重试")}finally{U.value=!1}}},X=()=>{_.value&&(G("generate-rule",_.value),ElMessage.success("规则已应用到配置中"))},Y=async()=>{if(g.expression){q.value=!0;try{await new Promise(r=>setTimeout(r,1500)),m.value={optimizedExpression:"discount = (price > 1000 && isVip) ? 0.1 : 0.05",suggestions:["将if-else语句优化为三元表达式，提高执行效率","简化了逻辑结构，提高了可读性","保持了原有逻辑的完整性","优化后的表达式更易于维护"],optimizeTypes:["性能优化","逻辑优化","可读性优化"]}}catch(r){console.error("优化规则失败:",r),ElMessage.error("优化规则失败，请稍后重试")}finally{q.value=!1}}},Z=()=>{m.value&&(G("optimize-rule",m.value),ElMessage.success("规则优化已应用"))},h=async()=>{if(!(C.ruleIds.length<2)){F.value=!0;try{await new Promise(r=>setTimeout(r,1500)),f.value={hasConflict:!0,conflicts:[{description:"两个规则在相同条件下设置了不同的折扣值，可能导致业务逻辑冲突",ruleIds:[1,3],solution:"建议合并这两个规则，或明确设置规则优先级"}]}}catch(r){console.error("检测冲突失败:",r),ElMessage.error("检测冲突失败，请稍后重试")}finally{F.value=!1}}},ee=async()=>{if(T.expression){M.value=!0;try{await new Promise(r=>setTimeout(r,1500)),w.value={explanation:"该规则用于验证产品重量必须在0到1000克之间，确保产品配置符合重量限制要求",ruleType:"validation",applicableScenarios:["产品配置过程中的重量验证","订单提交前的产品校验","报价生成前的规则检查"]}}catch(r){console.error("解释规则失败:",r),ElMessage.error("解释规则失败，请稍后重试")}finally{M.value=!1}}};return(r,e)=>{const S=d("el-tag"),B=d("el-input"),y=d("el-form-item"),I=d("el-option"),$=d("el-select"),b=d("el-icon"),x=d("el-button"),R=d("el-divider"),N=d("el-card"),E=d("el-tab-pane"),A=d("el-checkbox"),le=d("el-checkbox-group"),te=d("el-empty"),se=d("el-tabs");return i(),u("div",de,[t(N,{shadow:"hover",class:"ai-main-card"},{header:s(()=>[l("div",pe,[e[8]||(e[8]=l("span",null,"AI 辅助配置",-1)),t(S,{type:"info"},{default:s(()=>e[7]||(e[7]=[n("DeepSeek 驱动")])),_:1,__:[7]})])]),default:s(()=>[t(se,{modelValue:J.value,"onUpdate:modelValue":e[6]||(e[6]=o=>J.value=o),type:"border-card",class:"ai-function-tabs"},{default:s(()=>[t(E,{label:"自然语言生成",name:"generate"},{default:s(()=>[l("div",_e,[t(y,{label:"规则描述",required:""},{default:s(()=>[t(B,{modelValue:v.description,"onUpdate:modelValue":e[0]||(e[0]=o=>v.description=o),type:"textarea",placeholder:"请用自然语言描述规则，例如：当产品价格高于1000元且用户是VIP客户时，给予10%折扣",rows:4},null,8,["modelValue"]),e[9]||(e[9]=l("div",{class:"form-tip"},"示例：当产品价格高于1000元且用户是VIP客户时，给予10%折扣",-1))]),_:1,__:[9]}),t(y,{label:"规则类型"},{default:s(()=>[t($,{modelValue:v.ruleType,"onUpdate:modelValue":e[1]||(e[1]=o=>v.ruleType=o),placeholder:"请选择规则类型"},{default:s(()=>[t(I,{label:"验证规则",value:"validation"}),t(I,{label:"计算规则",value:"calculation"}),t(I,{label:"条件规则",value:"condition"}),t(I,{label:"跳转规则",value:"redirect"})]),_:1},8,["modelValue"])]),_:1}),l("div",ce,[t(x,{type:"primary",size:"large",loading:U.value,onClick:W},{default:s(()=>[t(b,null,{default:s(()=>[t(V(ie))]),_:1}),e[10]||(e[10]=n(" 生成规则 "))]),_:1,__:[10]},8,["loading"])]),_.value?(i(),u("div",me,[t(R,{"content-position":"left"},{default:s(()=>e[11]||(e[11]=[n("生成结果")])),_:1,__:[11]}),t(N,{shadow:"hover"},{header:s(()=>[l("div",fe,[e[13]||(e[13]=l("span",null,"AI 生成的规则",-1)),t(x,{type:"success",size:"small",onClick:X},{default:s(()=>[t(b,null,{default:s(()=>[t(V(H))]),_:1}),e[12]||(e[12]=n(" 应用规则 "))]),_:1,__:[12]})])]),default:s(()=>[l("div",ve,[l("div",ge,[e[14]||(e[14]=l("strong",null,"规则名称：",-1)),n(a(_.value.ruleName),1)]),l("div",ye,[e[15]||(e[15]=l("strong",null,"规则类型：",-1)),n(a(_.value.ruleType),1)]),l("div",be,[e[16]||(e[16]=l("strong",null,"条件配置：",-1)),l("pre",null,a(JSON.stringify(_.value.conditions,null,2)),1)]),l("div",xe,[e[17]||(e[17]=l("strong",null,"动作配置：",-1)),l("pre",null,a(JSON.stringify(_.value.actions,null,2)),1)]),l("div",Ve,[e[18]||(e[18]=l("strong",null,"规则表达式：",-1)),l("pre",null,a(_.value.ruleExpression),1)])])]),_:1})])):P("",!0)])]),_:1}),t(E,{label:"规则优化",name:"optimize"},{default:s(()=>[l("div",ke,[t(y,{label:"当前规则表达式",required:""},{default:s(()=>[t(B,{modelValue:g.expression,"onUpdate:modelValue":e[2]||(e[2]=o=>g.expression=o),type:"textarea",placeholder:"请输入要优化的规则表达式",rows:6},null,8,["modelValue"]),e[19]||(e[19]=l("div",{class:"form-tip"},"示例：if (price > 1000 && isVip) { discount = 0.1 } else { discount = 0.05 }",-1))]),_:1,__:[19]}),t(y,{label:"优化方向"},{default:s(()=>[t(le,{modelValue:g.optimizeDirections,"onUpdate:modelValue":e[3]||(e[3]=o=>g.optimizeDirections=o)},{default:s(()=>[t(A,{label:"性能优化"},{default:s(()=>e[20]||(e[20]=[n("性能优化")])),_:1,__:[20]}),t(A,{label:"逻辑优化"},{default:s(()=>e[21]||(e[21]=[n("逻辑优化")])),_:1,__:[21]}),t(A,{label:"可读性优化"},{default:s(()=>e[22]||(e[22]=[n("可读性优化")])),_:1,__:[22]}),t(A,{label:"完整性检查"},{default:s(()=>e[23]||(e[23]=[n("完整性检查")])),_:1,__:[23]})]),_:1},8,["modelValue"])]),_:1}),l("div",ze,[t(x,{type:"primary",size:"large",loading:q.value,onClick:Y},{default:s(()=>[t(b,null,{default:s(()=>[t(V(ae))]),_:1}),e[24]||(e[24]=n(" 优化规则 "))]),_:1,__:[24]},8,["loading"])]),m.value?(i(),u("div",we,[t(R,{"content-position":"left"},{default:s(()=>e[25]||(e[25]=[n("优化结果")])),_:1,__:[25]}),t(N,{shadow:"hover"},{header:s(()=>[l("div",Ie,[e[27]||(e[27]=l("span",null,"AI 优化的规则",-1)),t(x,{type:"success",size:"small",onClick:Z},{default:s(()=>[t(b,null,{default:s(()=>[t(V(H))]),_:1}),e[26]||(e[26]=n(" 应用优化 "))]),_:1,__:[26]})])]),default:s(()=>[l("div",Ne,[l("div",Ce,[e[28]||(e[28]=l("strong",null,"原表达式：",-1)),l("pre",null,a(g.expression),1)]),l("div",Te,[e[29]||(e[29]=l("strong",null,"优化后：",-1)),l("pre",null,a(m.value.optimizedExpression),1)]),l("div",Re,[e[30]||(e[30]=l("strong",null,"优化建议：",-1)),l("ul",Ee,[(i(!0),u(k,null,z(m.value.suggestions,(o,c)=>(i(),u("li",{key:c},a(o),1))),128))])]),l("div",Ae,[e[31]||(e[31]=l("strong",null,"优化类型：",-1)),(i(!0),u(k,null,z(m.value.optimizeTypes,(o,c)=>(i(),K(S,{key:c,type:"success",size:"small",class:"optimize-type-tag"},{default:s(()=>[n(a(o),1)]),_:2},1024))),128))])])]),_:1})])):P("",!0)])]),_:1}),t(E,{label:"冲突检测",name:"detect"},{default:s(()=>[l("div",De,[t(y,{label:"规则列表",required:""},{default:s(()=>[t($,{modelValue:C.ruleIds,"onUpdate:modelValue":e[4]||(e[4]=o=>C.ruleIds=o),placeholder:"请选择要检测冲突的规则",multiple:"","collapse-tags":"",style:{width:"100%"}},{default:s(()=>[(i(!0),u(k,null,z(L.value,o=>(i(),K(I,{key:o.ruleId,label:o.ruleName,value:o.ruleId},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e[32]||(e[32]=l("div",{class:"form-tip"},"选择要检测冲突的规则，至少选择2个",-1))]),_:1,__:[32]}),l("div",Pe,[t(x,{type:"primary",size:"large",loading:F.value,disabled:C.ruleIds.length<2,onClick:h},{default:s(()=>[t(b,null,{default:s(()=>[t(V(ue))]),_:1}),e[33]||(e[33]=n(" 检测冲突 "))]),_:1,__:[33]},8,["loading","disabled"])]),f.value?(i(),u("div",Ue,[t(R,{"content-position":"left"},{default:s(()=>e[34]||(e[34]=[n("冲突检测结果")])),_:1,__:[34]}),t(N,{shadow:"hover"},{header:s(()=>[l("div",qe,[e[35]||(e[35]=l("span",null,"冲突检测报告",-1)),t(S,{type:f.value.hasConflict?"danger":"success"},{default:s(()=>[n(a(f.value.hasConflict?"发现冲突":"无冲突"),1)]),_:1},8,["type"])])]),default:s(()=>[l("div",Fe,[f.value.hasConflict?(i(),u("div",Me,[l("div",Se,[e[36]||(e[36]=l("strong",null,"冲突数量：",-1)),n(a(f.value.conflicts.length),1)]),(i(!0),u(k,null,z(f.value.conflicts,(o,c)=>(i(),u("div",{key:c,class:"conflict-item"},[l("h4",null,"冲突 "+a(c+1),1),l("div",Be,a(o.description),1),l("div",Oe,[e[37]||(e[37]=l("strong",null,"冲突规则：",-1)),l("ul",null,[(i(!0),u(k,null,z(o.ruleIds,O=>{var j;return i(),u("li",{key:O},a(((j=L.value.find(oe=>oe.ruleId===O))==null?void 0:j.ruleName)||`规则ID: ${O}`),1)}),128))])]),l("div",Ge,[e[38]||(e[38]=l("strong",null,"建议解决方案：",-1)),n(a(o.solution),1)])]))),128))])):(i(),u("div",Je,[t(te,{description:"未检测到规则冲突"}),e[39]||(e[39]=l("div",{class:"success-message"},"所有规则之间没有冲突，可以安全使用。",-1))]))])]),_:1})])):P("",!0)])]),_:1}),t(E,{label:"规则解释",name:"explain"},{default:s(()=>[l("div",Le,[t(y,{label:"规则表达式",required:""},{default:s(()=>[t(B,{modelValue:T.expression,"onUpdate:modelValue":e[5]||(e[5]=o=>T.expression=o),type:"textarea",placeholder:"请输入要解释的规则表达式",rows:6},null,8,["modelValue"]),e[40]||(e[40]=l("div",{class:"form-tip"},"示例：weight > 0 && weight < 1000",-1))]),_:1,__:[40]}),l("div",$e,[t(x,{type:"primary",size:"large",loading:M.value,onClick:ee},{default:s(()=>[t(b,null,{default:s(()=>[t(V(re))]),_:1}),e[41]||(e[41]=n(" 解释规则 "))]),_:1,__:[41]},8,["loading"])]),w.value?(i(),u("div",je,[t(R,{"content-position":"left"},{default:s(()=>e[42]||(e[42]=[n("规则解释")])),_:1,__:[42]}),t(N,{shadow:"hover"},{header:s(()=>e[43]||(e[43]=[l("div",{class:"result-header"},[l("span",null,"规则解释结果")],-1)])),default:s(()=>[l("div",He,[l("div",Ke,[e[44]||(e[44]=l("strong",null,"规则表达式：",-1)),l("pre",null,a(T.expression),1)]),l("div",Qe,[e[45]||(e[45]=l("strong",null,"自然语言解释：",-1)),l("div",We,a(w.value.explanation),1)]),l("div",Xe,[e[46]||(e[46]=l("strong",null,"规则类型：",-1)),n(a(w.value.ruleType),1)]),l("div",Ye,[e[47]||(e[47]=l("strong",null,"适用场景：",-1)),l("ul",Ze,[(i(!0),u(k,null,z(w.value.applicableScenarios,(o,c)=>(i(),u("li",{key:c},a(o),1))),128))])])])]),_:1})])):P("",!0)])]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}},sl=ne(he,[["__scopeId","data-v-3d1557fe"]]);export{sl as default};
