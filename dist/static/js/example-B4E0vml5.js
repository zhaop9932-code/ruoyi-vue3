import z from"./RuleActionManage-DMercYQs.js";import G from"./ActionContent-BOqNEGN_.js";import{l as K,a as j,u as H,d as Q}from"./ruleAction-CXds5VRx.js";import{_ as W,r as v,a as u,c as y,o as c,b as t,w as n,e as l,t as p,F as X,n as Y,m as Z,f as s,k as V,E as d}from"./index-DgigFOm-.js";import"./actionConfig-C-hhf0v-.js";import"./ActionTypeSelector-DMQg9yzW.js";import"./TargetTypeSelector-CLltoMlE.js";import"./TargetObjectSelector-Bt4flkLc.js";import"./NodeSelector-DEupmx4h.js";import"./superBomStructure-C2O6seWy.js";import"./AttributeSelector-CyYPhvVA.js";import"./bom-CjuVRwkz.js";import"./superBomDynamicAttribute-6n4Uab6m.js";import"./superBomProductRelation-c5nmns4w.js";import"./index-DAib79Lj.js";import"./superBomVariable-_jqz_F6y.js";import"./ActionParamsConfig-Dhc9pdhZ.js";import"./BasicInfoSection-Cpw6sxwq.js";const h={class:"action-config-example"},ee={class:"card-header"},le={class:"action-preview"},te={key:0,class:"validation-errors"},ne={key:1,class:"validation-success"},oe={class:"scenario-content"},ae={class:"scenario-content"},ie={class:"scenario-content"},se={class:"scenario-content"},ue={class:"scenario-content"},re={key:0,class:"api-response"},de={key:0,class:"api-response"},pe={key:0,class:"api-response"},me={key:0,class:"api-response"},ce={__name:"example",setup(ve){const w=v("manage"),C=v(["1"]),f=v(1001),b=v(100),k=v({actionType:"",targetType:"",targetId:"",structureId:"",attributeId:"",actionParams:"{}",actionPriority:1,actionStatus:"0",actionSequence:1,description:""}),A=v({valid:!0,errors:[]}),r=v(!1),o=v({list:null,add:null,update:null,delete:null}),g={scenario1:{actionType:"linkSelect",targetType:"nodeProduct",structureId:"101",targetId:"201,202,203",actionParams:JSON.stringify({value:!0}),actionPriority:1,actionStatus:"0",actionSequence:1,description:"选择Intel主板后自动选中Intel CPU"},scenario2:{actionType:"applyDiscount",targetType:"node",targetId:"101,102,103",actionParams:JSON.stringify({type:"percentage",value:.9,isStackable:!1}),actionPriority:1,actionStatus:"0",actionSequence:1,description:"VIP客户享受9折优惠"},scenario3:{actionType:"multipleSelect",targetType:"nodeProduct",structureId:"102",targetId:"301,302,303",actionParams:JSON.stringify({minSelect:2,maxSelect:4}),actionPriority:1,actionStatus:"0",actionSequence:1,description:"内存条最少2条,最多4条"},scenario4:{actionType:"calculation",targetType:"variable",targetId:"1",actionParams:JSON.stringify({formula:"cpuPower + gpuPower + otherPower",resultStorage:"totalPower"}),actionPriority:1,actionStatus:"0",actionSequence:1,description:"计算总功耗"},scenario5:{actionType:"applyFullReduction",targetType:"node",targetId:"100",actionParams:JSON.stringify({conditionType:"amount",conditionValue:1e3,reduceType:"fixed",reduceValue:100,isLoop:!0}),actionPriority:1,actionStatus:"0",actionSequence:1,description:"满1000减100"}},O=a=>{A.value=a},S=a=>{const e=`scenario${a}`;k.value={...g[e],ruleId:f.value},w.value="single",d.success(`场景${a}配置已加载`)},J=async()=>{r.value=!0;try{const a=await K(f.value);o.value.list=a,d.success("查询成功")}catch{d.error("查询失败")}finally{r.value=!1}},q=async()=>{r.value=!0;try{const a={ruleId:f.value,actionType:"isEnable",actionName:"测试动作",targetType:"node",targetId:"101",actionParams:JSON.stringify({value:!0}),actionPriority:1,actionStatus:"0",actionSequence:1},e=await j(a);o.value.add=e,d.success("新增成功")}catch{d.error("新增失败")}finally{r.value=!1}},R=async()=>{if(!o.value.add||!o.value.add.data){d.warning("请先执行新增操作");return}r.value=!0;try{const a={actionId:o.value.add.data.actionId,actionName:"测试动作(已更新)",actionParams:JSON.stringify({value:!1})},e=await H(a);o.value.update=e,d.success("更新成功")}catch{d.error("更新失败")}finally{r.value=!1}},U=async()=>{if(!o.value.add||!o.value.add.data){d.warning("请先执行新增操作");return}r.value=!0;try{const a=o.value.add.data.actionId,e=await Q(a);o.value.delete=e,d.success("删除成功")}catch{d.error("删除失败")}finally{r.value=!1}};return(a,e)=>{const E=u("el-tag"),I=u("el-alert"),N=u("el-input-number"),x=u("el-form-item"),B=u("el-form"),T=u("el-tab-pane"),D=u("el-divider"),_=u("el-card"),m=u("el-button"),P=u("el-collapse-item"),$=u("el-collapse"),L=u("el-space"),F=u("el-tabs");return c(),y("div",h,[t(_,{shadow:"hover"},{header:n(()=>[l("div",ee,[e[11]||(e[11]=l("span",null,"动作配置示例页面",-1)),t(E,{type:"success"},{default:n(()=>e[10]||(e[10]=[s("演示")])),_:1,__:[10]})])]),default:n(()=>[t(F,{modelValue:w.value,"onUpdate:modelValue":e[9]||(e[9]=i=>w.value=i),type:"border-card"},{default:n(()=>[t(T,{label:"完整管理页面",name:"manage"},{default:n(()=>[t(I,{title:"完整的动作管理页面,包含新增、编辑、删除、批量操作等功能",type:"info",closable:!1,style:{"margin-bottom":"20px"}}),t(B,{inline:!0},{default:n(()=>[t(x,{label:"规则ID"},{default:n(()=>[t(N,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=i=>f.value=i),min:1},null,8,["modelValue"])]),_:1}),t(x,{label:"BOM ID"},{default:n(()=>[t(N,{modelValue:b.value,"onUpdate:modelValue":e[1]||(e[1]=i=>b.value=i),min:1},null,8,["modelValue"])]),_:1})]),_:1}),t(z,{"rule-id":f.value,"bom-id":b.value},null,8,["rule-id","bom-id"])]),_:1}),t(T,{label:"单个动作配置",name:"single"},{default:n(()=>[t(I,{title:"单独使用ActionContent组件,可嵌入到其他表单中",type:"info",closable:!1,style:{"margin-bottom":"20px"}}),t(_,null,{default:n(()=>[t(G,{element:k.value,"onUpdate:element":e[2]||(e[2]=i=>k.value=i),"is-expanded":!0,"bom-id":b.value,onValidate:O},null,8,["element","bom-id"]),t(D),l("div",le,[e[13]||(e[13]=l("h4",null,"当前配置数据:",-1)),l("pre",null,p(JSON.stringify(k.value,null,2)),1),A.value.errors.length>0?(c(),y("div",te,[e[12]||(e[12]=l("h4",null,"验证错误:",-1)),(c(!0),y(X,null,Y(A.value.errors,(i,M)=>(c(),Z(I,{key:M,title:i,type:"error",closable:!1,style:{"margin-bottom":"10px"}},null,8,["title"]))),128))])):(c(),y("div",ne,[t(I,{title:"配置验证通过!",type:"success",closable:!1})]))])]),_:1})]),_:1}),t(T,{label:"常见场景",name:"scenarios"},{default:n(()=>[t($,{modelValue:C.value,"onUpdate:modelValue":e[8]||(e[8]=i=>C.value=i)},{default:n(()=>[t(P,{title:"场景1: 选择Intel主板后自动选中Intel CPU",name:"1"},{default:n(()=>[l("div",oe,[e[15]||(e[15]=l("h4",null,"配置说明:",-1)),e[16]||(e[16]=l("ul",null,[l("li",null,"动作类型: 相互联动 - 联动选中"),l("li",null,"目标类型: 节点产品"),l("li",null,"选择节点: CPU节点"),l("li",null,"目标对象: Intel系列CPU产品(多选)"),l("li",null,'动作参数: 开关设为"是"')],-1)),e[17]||(e[17]=l("h4",null,"配置数据:",-1)),l("pre",null,p(g.scenario1),1),t(m,{type:"primary",onClick:e[3]||(e[3]=i=>S(1))},{default:n(()=>e[14]||(e[14]=[s(" 加载此配置 ")])),_:1,__:[14]})])]),_:1}),t(P,{title:"场景2: VIP客户享受9折优惠",name:"2"},{default:n(()=>[l("div",ae,[e[19]||(e[19]=l("h4",null,"配置说明:",-1)),e[20]||(e[20]=l("ul",null,[l("li",null,"动作类型: 价格动作 - 应用折扣"),l("li",null,"目标类型: 节点"),l("li",null,"目标对象: 选择需要打折的节点(多选)"),l("li",null,"折扣类型: 百分比"),l("li",null,"折扣值: 0.9 (即9折)"),l("li",null,"是否叠加: 否")],-1)),e[21]||(e[21]=l("h4",null,"配置数据:",-1)),l("pre",null,p(g.scenario2),1),t(m,{type:"primary",onClick:e[4]||(e[4]=i=>S(2))},{default:n(()=>e[18]||(e[18]=[s(" 加载此配置 ")])),_:1,__:[18]})])]),_:1}),t(P,{title:"场景3: 内存条最少2条,最多4条",name:"3"},{default:n(()=>[l("div",ie,[e[23]||(e[23]=l("h4",null,"配置说明:",-1)),e[24]||(e[24]=l("ul",null,[l("li",null,"动作类型: 相互联动 - 多选"),l("li",null,"目标类型: 节点产品"),l("li",null,"选择节点: 内存节点"),l("li",null,"目标对象: 内存产品(多选)"),l("li",null,"最少选择数量: 2"),l("li",null,"最多选择数量: 4")],-1)),e[25]||(e[25]=l("h4",null,"配置数据:",-1)),l("pre",null,p(g.scenario3),1),t(m,{type:"primary",onClick:e[5]||(e[5]=i=>S(3))},{default:n(()=>e[22]||(e[22]=[s(" 加载此配置 ")])),_:1,__:[22]})])]),_:1}),t(P,{title:"场景4: 计算总功耗",name:"4"},{default:n(()=>[l("div",se,[e[27]||(e[27]=l("h4",null,"配置说明:",-1)),e[28]||(e[28]=l("ul",null,[l("li",null,"动作类型: 数据处理 - 参数计算"),l("li",null,"目标类型: 变量信息"),l("li",null,'目标对象: 选择"总功耗"变量'),l("li",null,"计算公式: cpuPower + gpuPower + otherPower"),l("li",null,"结果存储到: totalPower")],-1)),e[29]||(e[29]=l("h4",null,"配置数据:",-1)),l("pre",null,p(g.scenario4),1),t(m,{type:"primary",onClick:e[6]||(e[6]=i=>S(4))},{default:n(()=>e[26]||(e[26]=[s(" 加载此配置 ")])),_:1,__:[26]})])]),_:1}),t(P,{title:"场景5: 满1000减100",name:"5"},{default:n(()=>[l("div",ue,[e[31]||(e[31]=l("h4",null,"配置说明:",-1)),e[32]||(e[32]=l("ul",null,[l("li",null,"动作类型: 价格动作 - 应用满减"),l("li",null,"目标类型: 节点"),l("li",null,"目标对象: 选择参与活动的节点(单选)"),l("li",null,"满减条件类型: 满金额"),l("li",null,"条件值: 1000"),l("li",null,"减额类型: 固定金额"),l("li",null,"减额值: 100"),l("li",null,"是否循环满减: 是")],-1)),e[33]||(e[33]=l("h4",null,"配置数据:",-1)),l("pre",null,p(g.scenario5),1),t(m,{type:"primary",onClick:e[7]||(e[7]=i=>S(5))},{default:n(()=>e[30]||(e[30]=[s(" 加载此配置 ")])),_:1,__:[30]})])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(T,{label:"API调用",name:"api"},{default:n(()=>[t(I,{title:"展示如何通过API进行动作的增删改查操作",type:"info",closable:!1,style:{"margin-bottom":"20px"}}),t(L,{direction:"vertical",size:20,style:{width:"100%"}},{default:n(()=>[t(_,null,{header:n(()=>e[34]||(e[34]=[s("查询动作列表")])),default:n(()=>[t(m,{type:"primary",onClick:J,loading:r.value},{default:n(()=>e[35]||(e[35]=[s(" GET /cpq/ruleAction/listByRuleId/{ruleId} ")])),_:1,__:[35]},8,["loading"]),o.value.list?(c(),y("div",re,[e[36]||(e[36]=l("h4",null,"响应数据:",-1)),l("pre",null,p(JSON.stringify(o.value.list,null,2)),1)])):V("",!0)]),_:1}),t(_,null,{header:n(()=>e[37]||(e[37]=[s("新增动作")])),default:n(()=>[t(m,{type:"success",onClick:q,loading:r.value},{default:n(()=>e[38]||(e[38]=[s(" POST /cpq/ruleAction ")])),_:1,__:[38]},8,["loading"]),o.value.add?(c(),y("div",de,[e[39]||(e[39]=l("h4",null,"响应数据:",-1)),l("pre",null,p(JSON.stringify(o.value.add,null,2)),1)])):V("",!0)]),_:1}),t(_,null,{header:n(()=>e[40]||(e[40]=[s("更新动作")])),default:n(()=>[t(m,{type:"warning",onClick:R,loading:r.value},{default:n(()=>e[41]||(e[41]=[s(" PUT /cpq/ruleAction ")])),_:1,__:[41]},8,["loading"]),o.value.update?(c(),y("div",pe,[e[42]||(e[42]=l("h4",null,"响应数据:",-1)),l("pre",null,p(JSON.stringify(o.value.update,null,2)),1)])):V("",!0)]),_:1}),t(_,null,{header:n(()=>e[43]||(e[43]=[s("删除动作")])),default:n(()=>[t(m,{type:"danger",onClick:U,loading:r.value},{default:n(()=>e[44]||(e[44]=[s(" DELETE /cpq/ruleAction/{actionId} ")])),_:1,__:[44]},8,["loading"]),o.value.delete?(c(),y("div",me,[e[45]||(e[45]=l("h4",null,"响应数据:",-1)),l("pre",null,p(JSON.stringify(o.value.delete,null,2)),1)])):V("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})])}}},qe=W(ce,[["__scopeId","data-v-6a3fa766"]]);export{qe as default};
