/* empty css                                                                            */import{_ as Z,r as f,g as C,h as ee,i as oe,a as p,j as te,c as P,o as x,e as v,b as o,w as a,f as b,k as le,m as re,t as ae,q as pe,E as i,n as k}from"./index-kbfDsxmo.js";const ne={class:"bom-node-dynamic-props"},se={class:"dynamic-props-header"},ue={class:"dynamic-props-content"},de={class:"table-footer"},ie={key:0,class:"selection-actions"},me={class:"dialog-footer"},ce={__name:"BomNodeDynamicProps",props:{bomId:{type:[String,Number],required:!0},bomStructureId:{type:[String,Number],default:null}},setup(z){const u=z,h=f(!1),n=f([]),y=f([]),_=f(!1),S=f("新增动态属性"),T=f(null),r=C({propId:null,bomId:u.bomId,bomStructureId:u.bomStructureId,propName:"",propKey:"",propValue:"",propType:"string",status:"enabled",priority:0,description:""}),D=C({propName:[{required:!0,message:"属性名称不能为空",trigger:"blur"}],propKey:[{required:!0,message:"属性键不能为空",trigger:"blur"}],propType:[{required:!0,message:"请选择属性类型",trigger:"change"}],status:[{required:!0,message:"请选择状态",trigger:"change"}],priority:[{required:!0,message:"请输入优先级",trigger:"blur"},{type:"number",min:1,max:10,message:"优先级必须在1-10之间",trigger:"blur"}]}),s=C({currentPage:1,pageSize:10,total:0}),B=t=>({string:"字符串",number:"数字",boolean:"布尔值",array:"数组",object:"对象"})[t]||t,U=t=>({string:"primary",number:"success",boolean:"warning",array:"info",object:"danger"})[t]||"primary",V=()=>{h.value=!0,setTimeout(()=>{n.value=[{propId:1,bomId:u.bomId,bomStructureId:u.bomStructureId||1,propName:"颜色",propKey:"color",propValue:"红色",propType:"string",status:"enabled",priority:1,description:"产品颜色"},{propId:2,bomId:u.bomId,bomStructureId:u.bomStructureId||1,propName:"尺寸",propKey:"size",propValue:"M",propType:"string",status:"enabled",priority:2,description:"产品尺寸"},{propId:3,bomId:u.bomId,bomStructureId:u.bomStructureId||1,propName:"重量",propKey:"weight",propValue:"1.5",propType:"number",status:"enabled",priority:3,description:"产品重量"}],h.value=!1},500)};ee(()=>u.bomStructureId,t=>{r.bomStructureId=t,V()});const K=()=>{F(),S.value="新增动态属性",_.value=!0},M=t=>{Object.assign(r,{...t}),S.value="编辑动态属性",_.value=!0},q=async t=>{try{await k.confirm(`确定要删除动态属性 "${t.propName}" 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const e=n.value.findIndex(m=>m.propId===t.propId);e!==-1&&(n.value.splice(e,1),s.total=n.value.length,i.success("动态属性删除成功"))}catch(e){e!=="cancel"&&(i.error("删除失败"),console.error("删除动态属性失败:",e))}},$=async()=>{if(y.value.length===0){i.warning("请选择要删除的动态属性");return}try{await k.confirm(`确定要删除选中的 ${y.value.length} 个动态属性吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"});const t=y.value.map(e=>e.propId);n.value=n.value.filter(e=>!t.includes(e.propId)),s.total=n.value.length,y.value=[],i.success("动态属性批量删除成功")}catch(t){t!=="cancel"&&(i.error("批量删除失败"),console.error("批量删除动态属性失败:",t))}},j=t=>{i.success(`动态属性状态已更新为${t.status==="enabled"?"启用":"禁用"}`)},E=async()=>{try{if(await T.value.validate(),r.propId){const t=n.value.findIndex(e=>e.propId===r.propId);t!==-1&&(n.value[t]={...r}),i.success("动态属性更新成功")}else{const t={...r,propId:Date.now()};n.value.unshift(t),s.total=n.value.length,i.success("动态属性新增成功")}_.value=!1}catch(t){t!==!1&&(i.error("操作失败，请检查表单数据"),console.error("提交动态属性表单失败:",t))}},F=()=>{var t;r.propId=null,r.propName="",r.propKey="",r.propValue="",r.propType="string",r.status="enabled",r.priority=1,r.description="",(t=T.value)==null||t.resetFields()},R=t=>{y.value=t},A=t=>{s.pageSize=t,V()},L=t=>{s.currentPage=t,V()};return oe(()=>{V()}),(t,e)=>{const m=p("el-button"),d=p("el-table-column"),O=p("el-tag"),G=p("el-switch"),H=p("el-table"),J=p("el-pagination"),I=p("el-input"),c=p("el-form-item"),g=p("el-option"),N=p("el-select"),Q=p("el-input-number"),W=p("el-form"),X=p("el-dialog"),Y=te("loading");return x(),P("div",ne,[v("div",se,[e[12]||(e[12]=v("h4",null,"动态属性管理",-1)),o(m,{type:"primary",icon:"Plus",onClick:K},{default:a(()=>e[11]||(e[11]=[b("新增动态属性")])),_:1,__:[11]})]),v("div",ue,[le((x(),re(H,{data:n.value,border:"",style:{width:"100%"},onSelectionChange:R},{default:a(()=>[o(d,{type:"selection",width:"55"}),o(d,{prop:"propId",label:"属性ID",width:"120"}),o(d,{prop:"propName",label:"属性名称",width:"180"}),o(d,{prop:"propKey",label:"属性键",width:"180"}),o(d,{prop:"propValue",label:"属性值",width:"180"}),o(d,{prop:"propType",label:"属性类型",width:"120"},{default:a(l=>[o(O,{type:U(l.row.propType)},{default:a(()=>[b(ae(B(l.row.propType)),1)]),_:2},1032,["type"])]),_:1}),o(d,{prop:"status",label:"状态",width:"100"},{default:a(l=>[o(G,{modelValue:l.row.status,"onUpdate:modelValue":w=>l.row.status=w,"active-value":"enabled","inactive-value":"disabled",onChange:w=>j(l.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),o(d,{prop:"priority",label:"优先级",width:"100"}),o(d,{label:"操作",width:"180",fixed:"right"},{default:a(l=>[o(m,{type:"primary",size:"small",icon:"Edit",onClick:w=>M(l.row)},{default:a(()=>e[13]||(e[13]=[b("编辑")])),_:2,__:[13]},1032,["onClick"]),o(m,{type:"danger",size:"small",icon:"Delete",onClick:w=>q(l.row)},{default:a(()=>e[14]||(e[14]=[b("删除")])),_:2,__:[14]},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Y,h.value]]),v("div",de,[y.value.length>0?(x(),P("div",ie,[o(m,{type:"danger",icon:"Delete",onClick:$},{default:a(()=>e[15]||(e[15]=[b("批量删除")])),_:1,__:[15]})])):pe("",!0),o(J,{"current-page":s.currentPage,"onUpdate:currentPage":e[0]||(e[0]=l=>s.currentPage=l),"page-size":s.pageSize,"onUpdate:pageSize":e[1]||(e[1]=l=>s.pageSize=l),"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:s.total,onSizeChange:A,onCurrentChange:L},null,8,["current-page","page-size","total"])])]),o(X,{title:S.value,modelValue:_.value,"onUpdate:modelValue":e[10]||(e[10]=l=>_.value=l),width:"600px","append-to-body":""},{footer:a(()=>[v("span",me,[o(m,{onClick:e[9]||(e[9]=l=>_.value=!1)},{default:a(()=>e[16]||(e[16]=[b("取消")])),_:1,__:[16]}),o(m,{type:"primary",onClick:E},{default:a(()=>e[17]||(e[17]=[b("确定")])),_:1,__:[17]})])]),default:a(()=>[o(W,{ref_key:"propFormRef",ref:T,model:r,rules:D,"label-width":"120px"},{default:a(()=>[o(c,{label:"属性名称",prop:"propName"},{default:a(()=>[o(I,{modelValue:r.propName,"onUpdate:modelValue":e[2]||(e[2]=l=>r.propName=l),placeholder:"请输入属性名称"},null,8,["modelValue"])]),_:1}),o(c,{label:"属性键",prop:"propKey"},{default:a(()=>[o(I,{modelValue:r.propKey,"onUpdate:modelValue":e[3]||(e[3]=l=>r.propKey=l),placeholder:"请输入属性键"},null,8,["modelValue"])]),_:1}),o(c,{label:"属性值",prop:"propValue"},{default:a(()=>[o(I,{modelValue:r.propValue,"onUpdate:modelValue":e[4]||(e[4]=l=>r.propValue=l),placeholder:"请输入属性值"},null,8,["modelValue"])]),_:1}),o(c,{label:"属性类型",prop:"propType"},{default:a(()=>[o(N,{modelValue:r.propType,"onUpdate:modelValue":e[5]||(e[5]=l=>r.propType=l),placeholder:"请选择属性类型"},{default:a(()=>[o(g,{label:"字符串",value:"string"}),o(g,{label:"数字",value:"number"}),o(g,{label:"布尔值",value:"boolean"}),o(g,{label:"数组",value:"array"}),o(g,{label:"对象",value:"object"})]),_:1},8,["modelValue"])]),_:1}),o(c,{label:"状态",prop:"status"},{default:a(()=>[o(N,{modelValue:r.status,"onUpdate:modelValue":e[6]||(e[6]=l=>r.status=l),placeholder:"请选择状态"},{default:a(()=>[o(g,{label:"启用",value:"enabled"}),o(g,{label:"禁用",value:"disabled"})]),_:1},8,["modelValue"])]),_:1}),o(c,{label:"优先级",prop:"priority"},{default:a(()=>[o(Q,{modelValue:r.priority,"onUpdate:modelValue":e[7]||(e[7]=l=>r.priority=l),min:1,max:10,step:1,placeholder:"请输入优先级"},null,8,["modelValue"])]),_:1}),o(c,{label:"描述",prop:"description"},{default:a(()=>[o(I,{modelValue:r.description,"onUpdate:modelValue":e[8]||(e[8]=l=>r.description=l),type:"textarea",placeholder:"请输入属性描述",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}},ye=Z(ce,[["__scopeId","data-v-c90f6cfd"]]);export{ye as default};
