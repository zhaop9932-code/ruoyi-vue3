import{_ as F,r as _,g as L,h as j,a as i,c as M,o as y,b as e,w as l,m as V,q as $,e as S,N as v,a2 as z,ak as G,al as Q,f as U,E as q}from"./index-kbfDsxmo.js";import{I as H}from"./index-BKHIMnA4.js";import{e as K}from"./bom-uPfK0qwF.js";const W={class:"bom-node-info-detail"},X={class:"field-with-tooltip"},Y={class:"field-with-tooltip"},Z={class:"form-actions"},ee={__name:"BomNodeInfoDetail",props:{bomId:{type:[String,Number],required:!0},bomStructureId:{type:[String,Number],required:!0},selectedNode:{type:Object,required:!0}},emits:["node-updated"],setup(D,{emit:w}){const g=D,I=_(null),E=r=>{t.value.icon=r},h=()=>{},x=_(null),t=_({isRequired:"0",selectionType:"single",minSelection:0,maxSelection:0,isQuantityEditable:"0",icon:"",nodeDescription:"",conditionExpr:"",defaultQuantity:null,minQuantity:null,minQuantityExpr:"",maxQuantity:null,maxQuantityExpr:"",constraintType:"",constraintConfig:"",delFlag:"0",rootNodeId:null,nodePath:"",depth:0,sortOrder:0,version:"",versionDescription:"",isLatest:"1",versionStatus:"draft",nodeStatus:"active",approvalStatus:"pending",approvalBy:"",approvalTime:"",effectiveDate:"",expireDate:"",isActive:"1",enableDynamicAttributes:"0",generateTempPartNumber:"0",dependentNodeIds:"[]",dependencyType:"",dependencyCondition:"",replaceableNodeIds:"[]",replacementCondition:"",costType:"",costCurrency:"",costCalculationRule:"",costComponents:"",price:null,priceType:"",priceCurrency:"",priceCalculationRule:"",priceComponents:"",iconUrl:"",nodeStyle:"",nodeColor:"",nodeShape:"",longDescription:"",documentationUrl:"",helpText:"",exampleUsage:"[]",...g.selectedNode}),f=_(JSON.parse(JSON.stringify(g.selectedNode))),R=L({nodeCode:[{required:!0,message:"节点编码不能为空",trigger:"blur"}],nodeName:[{required:!0,message:"节点名称不能为空",trigger:"blur"}],nodeType:[{required:!0,message:"请选择节点类型",trigger:"change"}],defaultQuantity:[{required:!0,message:"请输入默认数量",trigger:"blur"},{type:"number",min:0,message:"默认数量不能小于0",trigger:"blur"}],nodeStatus:[{required:!0,message:"请选择节点状态",trigger:"change"}],isRequired:[{required:!0,message:"请选择是否必选",trigger:"change"}],selectionType:[{required:!0,message:"请选择选择类型",trigger:"change"}],minSelection:[{type:"number",min:0,message:"最少选择数量不能小于0",trigger:"blur"}],maxSelection:[{type:"number",min:0,message:"最多选择数量不能小于0",trigger:"blur"}],isQuantityEditable:[{required:!0,message:"请选择数量是否可编辑",trigger:"change"}]});j(()=>g.selectedNode,r=>{t.value={isRequired:"0",selectionType:"single",minSelection:0,maxSelection:0,isQuantityEditable:"0",icon:"",nodeDescription:"",conditionExpr:"",defaultQuantity:null,minQuantity:null,minQuantityExpr:"",maxQuantity:null,maxQuantityExpr:"",constraintType:"",constraintConfig:"",delFlag:"0",rootNodeId:null,nodePath:"",depth:0,sortOrder:0,version:"",versionDescription:"",isLatest:"1",versionStatus:"draft",nodeStatus:"active",approvalStatus:"pending",approvalBy:"",approvalTime:"",effectiveDate:"",expireDate:"",isActive:"1",enableDynamicAttributes:"0",generateTempPartNumber:"0",dependentNodeIds:"[]",dependencyType:"",dependencyCondition:"",replaceableNodeIds:"[]",replacementCondition:"",costType:"",costCurrency:"",costCalculationRule:"",costComponents:"",price:null,priceType:"",priceCurrency:"",priceCalculationRule:"",priceComponents:"",iconUrl:"",nodeStyle:"",nodeColor:"",nodeShape:"",longDescription:"",documentationUrl:"",helpText:"",exampleUsage:"[]",...r},f.value=JSON.parse(JSON.stringify(t.value))},{deep:!0});const k=async()=>{try{await x.value.validate(),await K(t.value),q.success("节点保存成功"),f.value=JSON.parse(JSON.stringify(t.value)),P("node-updated",t.value)}catch(r){r!==!1&&(q.error("保存失败，请检查表单数据"),console.error("保存节点失败:",r))}},B=()=>{f.value&&(t.value={...f.value})},O=r=>r?`父节点${r}`:"根节点",P=w;return(r,a)=>{const s=i("el-input"),n=i("el-form-item"),u=i("el-col"),p=i("el-row"),d=i("el-option"),m=i("el-select"),c=i("el-input-number"),b=i("el-icon"),A=i("el-popover"),N=i("el-tooltip"),C=i("el-switch"),T=i("el-button"),J=i("el-form");return y(),M("div",W,[e(J,{ref_key:"nodeFormRef",ref:x,model:t.value,rules:R,"label-width":"120px"},{default:l(()=>[e(p,{gutter:20},{default:l(()=>[e(u,{span:12},{default:l(()=>[e(n,{label:"节点编码",prop:"nodeCode"},{default:l(()=>[e(s,{modelValue:t.value.nodeCode,"onUpdate:modelValue":a[0]||(a[0]=o=>t.value.nodeCode=o),placeholder:"请输入节点编码"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"节点名称",prop:"nodeName"},{default:l(()=>[e(s,{modelValue:t.value.nodeName,"onUpdate:modelValue":a[1]||(a[1]=o=>t.value.nodeName=o),placeholder:"请输入节点名称"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(p,{gutter:20},{default:l(()=>[e(u,{span:12},{default:l(()=>[e(n,{label:"节点类型",prop:"nodeType"},{default:l(()=>[e(m,{modelValue:t.value.nodeType,"onUpdate:modelValue":a[2]||(a[2]=o=>t.value.nodeType=o),placeholder:"请选择节点类型"},{default:l(()=>[e(d,{label:"物料",value:"0"}),e(d,{label:"组件",value:"1"}),e(d,{label:"服务",value:"2"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"父节点",prop:"parentNodeId"},{default:l(()=>[e(s,{value:O(t.value.parentNodeId),disabled:"",placeholder:"父节点名称"},null,8,["value"])]),_:1})]),_:1})]),_:1}),e(p,{gutter:20},{default:l(()=>[e(u,{span:12},{default:l(()=>[e(n,{label:"默认数量",prop:"defaultQuantity"},{default:l(()=>[e(c,{modelValue:t.value.defaultQuantity,"onUpdate:modelValue":a[3]||(a[3]=o=>t.value.defaultQuantity=o),min:0,step:.1,placeholder:"请输入默认数量"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"单位",prop:"unit"},{default:l(()=>[e(s,{modelValue:t.value.unit,"onUpdate:modelValue":a[4]||(a[4]=o=>t.value.unit=o),placeholder:"请输入单位"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(p,{gutter:20},{default:l(()=>[e(u,{span:12},{default:l(()=>[e(n,{label:"最小数量",prop:"minQuantity"},{default:l(()=>[e(c,{modelValue:t.value.minQuantity,"onUpdate:modelValue":a[5]||(a[5]=o=>t.value.minQuantity=o),min:0,step:.1,placeholder:"请输入最小数量"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"最大数量",prop:"maxQuantity"},{default:l(()=>[e(c,{modelValue:t.value.maxQuantity,"onUpdate:modelValue":a[6]||(a[6]=o=>t.value.maxQuantity=o),min:0,step:.1,placeholder:"请输入最大数量"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(p,{gutter:20},{default:l(()=>[e(u,{span:12},{default:l(()=>[e(n,{label:"节点状态",prop:"nodeStatus"},{default:l(()=>[e(m,{modelValue:t.value.nodeStatus,"onUpdate:modelValue":a[7]||(a[7]=o=>t.value.nodeStatus=o),placeholder:"请选择节点状态"},{default:l(()=>[e(d,{label:"激活",value:"active"}),e(d,{label:"停用",value:"inactive"}),e(d,{label:"草稿",value:"draft"}),e(d,{label:"已批准",value:"approved"}),e(d,{label:"已弃用",value:"deprecated"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(p,{gutter:20},{default:l(()=>[e(u,{span:12},{default:l(()=>[e(n,{label:"是否必选",prop:"isRequired"},{default:l(()=>[e(m,{modelValue:t.value.isRequired,"onUpdate:modelValue":a[8]||(a[8]=o=>t.value.isRequired=o),placeholder:"请选择是否必选"},{default:l(()=>[e(d,{label:"可选",value:"0"}),e(d,{label:"必选",value:"1"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"选择类型",prop:"selectionType"},{default:l(()=>[e(m,{modelValue:t.value.selectionType,"onUpdate:modelValue":a[9]||(a[9]=o=>t.value.selectionType=o),placeholder:"请选择选择类型"},{default:l(()=>[e(d,{label:"单选",value:"single"}),e(d,{label:"多选",value:"multiple"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t.value.selectionType==="multiple"?(y(),V(p,{key:0,gutter:20},{default:l(()=>[e(u,{span:12},{default:l(()=>[e(n,{label:"最少选择数量",prop:"minSelection"},{default:l(()=>[e(c,{modelValue:t.value.minSelection,"onUpdate:modelValue":a[10]||(a[10]=o=>t.value.minSelection=o),min:0,step:1,placeholder:"最少选择数量"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"最多选择数量",prop:"maxSelection"},{default:l(()=>[e(c,{modelValue:t.value.maxSelection,"onUpdate:modelValue":a[11]||(a[11]=o=>t.value.maxSelection=o),min:0,step:1,placeholder:"最多选择数量"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})):$("",!0),e(p,{gutter:20},{default:l(()=>[e(u,{span:12},{default:l(()=>[e(n,{label:"数量是否可编辑",prop:"isQuantityEditable"},{default:l(()=>[e(m,{modelValue:t.value.isQuantityEditable,"onUpdate:modelValue":a[12]||(a[12]=o=>t.value.isQuantityEditable=o),placeholder:"请选择数量是否可编辑"},{default:l(()=>[e(d,{label:"不可编辑",value:"0"}),e(d,{label:"可编辑",value:"1"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"图标",prop:"icon"},{default:l(()=>[e(A,{placement:"bottom-start",width:540,trigger:"click"},{reference:l(()=>[e(s,{modelValue:t.value.icon,"onUpdate:modelValue":a[13]||(a[13]=o=>t.value.icon=o),placeholder:"点击选择图标",onBlur:h,readonly:""},{prefix:l(()=>[t.value.icon?(y(),V(v(z),{key:0,"icon-class":t.value.icon,class:"el-input__icon",style:{height:"32px",width:"16px"}},null,8,["icon-class"])):(y(),V(b,{key:1,style:{height:"32px",width:"16px"}},{default:l(()=>[e(v(G))]),_:1}))]),_:1},8,["modelValue"])]),default:l(()=>[e(v(H),{ref_key:"iconSelectRef",ref:I,onSelected:E,"active-icon":t.value.icon},null,8,["active-icon"])]),_:1})]),_:1})]),_:1})]),_:1}),e(p,{gutter:20},{default:l(()=>[e(u,{span:12},{default:l(()=>[e(n,{label:"启用动态属性"},{default:l(()=>[S("div",X,[e(N,{placement:"top",content:"开启后用户选型页面自动展示关联产品的属性，供用户根据属性选配"},{default:l(()=>[e(b,{class:"question-icon"},{default:l(()=>[e(v(Q))]),_:1})]),_:1})]),e(C,{modelValue:t.value.enableDynamicAttributes,"onUpdate:modelValue":a[14]||(a[14]=o=>t.value.enableDynamicAttributes=o),"active-value":"1","inactive-value":"0","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})]),_:1}),e(u,{span:12},{default:l(()=>[e(n,{label:"生成临时料号"},{default:l(()=>[S("div",Y,[e(N,{placement:"center",content:"开启后，临时型号会根据规则自动生成"},{default:l(()=>[e(b,{class:"question-icon"},{default:l(()=>[e(v(Q))]),_:1})]),_:1})]),e(C,{modelValue:t.value.generateTempPartNumber,"onUpdate:modelValue":a[15]||(a[15]=o=>t.value.generateTempPartNumber=o),"active-value":"1","inactive-value":"0","active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(n,{label:"节点说明",prop:"nodeDescription"},{default:l(()=>[e(s,{modelValue:t.value.nodeDescription,"onUpdate:modelValue":a[16]||(a[16]=o=>t.value.nodeDescription=o),type:"textarea",placeholder:"请输入节点说明",rows:3},null,8,["modelValue"])]),_:1}),e(n,{label:"描述",prop:"description"},{default:l(()=>[e(s,{modelValue:t.value.description,"onUpdate:modelValue":a[17]||(a[17]=o=>t.value.description=o),type:"textarea",placeholder:"请输入节点描述",rows:4},null,8,["modelValue"])]),_:1}),S("div",Z,[e(T,{type:"primary",onClick:k},{default:l(()=>a[18]||(a[18]=[U("保存")])),_:1,__:[18]}),e(T,{onClick:B},{default:l(()=>a[19]||(a[19]=[U("取消")])),_:1,__:[19]})])]),_:1},8,["model","rules"])])}}},oe=F(ee,[["__scopeId","data-v-a6c811a2"]]);export{oe as default};
