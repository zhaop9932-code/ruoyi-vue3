import{_ as P,u as A,r as u,g as R,h as Y,a as i,i as G,c as p,o as d,e as t,j as H,k as J,b as o,l as c,s as K,m as z,F as Q,n as W,E as L,w as n,f as g,t as l,p as X,q as Z,v as ee,x as V,y as te,z as se,A as ae}from"./index-DgigFOm-.js";import{l as oe}from"./bom-CjuVRwkz.js";const ne={class:"configurator-list"},le={class:"list-header"},ie={class:"header-right"},re={class:"bom-list"},de={key:1,class:"bom-cards"},ce={class:"card-header"},ue={class:"bom-title"},_e={class:"card-body"},pe={class:"bom-desc"},ve={class:"bom-info"},me={class:"info-item"},fe={class:"info-item"},he={class:"info-item"},ge={class:"bom-stats"},Ce={class:"stat-item"},ye={class:"stat-value"},Se={class:"stat-item"},ke={class:"stat-value"},we={class:"stat-item"},Me={class:"stat-value"},Be={class:"card-actions"},be={key:0,class:"pagination"},xe={__name:"list",setup(Ne){const M=A(),v=u(""),C=u(!1),y=u([]),m=u(1),S=u(12),B=u(0),k=R(()=>{let s=y.value;if(v.value){const e=v.value.toLowerCase();s=s.filter(_=>{var f,r,h;return((f=_.bomName)==null?void 0:f.toLowerCase().includes(e))||((r=_.bomCode)==null?void 0:r.toLowerCase().includes(e))||((h=_.remark)==null?void 0:h.toLowerCase().includes(e))})}return s}),$=s=>{if(!s)return"-";const e=new Date(s);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`},w=async()=>{C.value=!0;try{const s=await oe({pageNum:m.value,pageSize:S.value,bomStatus:"1"});y.value=s.rows||[],B.value=s.total||0,y.value.forEach(e=>{e.nodeCount=e.nodeCount||Math.floor(Math.random()*20)+5,e.attributeCount=e.attributeCount||Math.floor(Math.random()*30)+10,e.ruleCount=e.ruleCount||Math.floor(Math.random()*15)+3})}catch(s){console.error("加载BOM列表失败:",s),L.error("加载BOM列表失败")}finally{C.value=!1}},D=()=>{m.value=1},I=s=>{if(s.bomStatus!=="1"){L.warning("该BOM方案已禁用，无法配置");return}b(s)},b=s=>{M.push({path:`/userselect/configurator/${s.bomId}`,query:{bomName:s.bomName}})},O=s=>{M.push({path:"/cpq/bom/manage",query:{bomId:s.bomId,bomName:s.bomName}})},q=()=>{w()},E=()=>{w()};return Y(()=>{w()}),(s,e)=>{const _=i("el-input"),f=i("el-empty"),r=i("el-icon"),h=i("el-tag"),F=i("el-text"),x=i("el-button"),T=i("el-card"),U=i("el-pagination"),j=G("loading");return d(),p("div",ne,[t("div",le,[e[3]||(e[3]=t("div",{class:"header-left"},[t("h2",null,"产品配置选型"),t("p",{class:"header-desc"},"选择一个BOM方案开始配置")],-1)),t("div",ie,[o(_,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=a=>v.value=a),placeholder:"搜索BOM方案","prefix-icon":c(K),clearable:"",style:{width:"300px"},onInput:D},null,8,["modelValue","prefix-icon"])])]),H((d(),p("div",re,[k.value.length===0?(d(),z(f,{key:0,description:"暂无BOM方案"})):(d(),p("div",de,[(d(!0),p(Q,null,W(k.value,a=>(d(),z(T,{key:a.bomId,class:"bom-card",shadow:"hover",onClick:N=>I(a)},{header:n(()=>[t("div",ce,[t("div",ue,[o(r,null,{default:n(()=>[o(c(ae))]),_:1}),t("span",null,l(a.bomName),1)]),o(h,{type:a.bomStatus==="1"?"success":"info",size:"small"},{default:n(()=>[g(l(a.bomStatus==="1"?"启用":"禁用"),1)]),_:2},1032,["type"])])]),default:n(()=>[t("div",_e,[t("div",pe,[o(F,{type:"info","line-clamp":"2"},{default:n(()=>[g(l(a.remark||"暂无描述"),1)]),_:2},1024)]),t("div",ve,[t("div",me,[o(r,null,{default:n(()=>[o(c(X))]),_:1}),t("span",null,"编码："+l(a.bomCode),1)]),t("div",fe,[o(r,null,{default:n(()=>[o(c(Z))]),_:1}),t("span",null,"目录："+l(a.catalogName||"-"),1)]),t("div",he,[o(r,null,{default:n(()=>[o(c(ee))]),_:1}),t("span",null,"创建时间："+l($(a.createTime)),1)])]),t("div",ge,[t("div",Ce,[t("div",ye,l(a.nodeCount||0),1),e[4]||(e[4]=t("div",{class:"stat-label"},"节点数",-1))]),t("div",Se,[t("div",ke,l(a.attributeCount||0),1),e[5]||(e[5]=t("div",{class:"stat-label"},"属性数",-1))]),t("div",we,[t("div",Me,l(a.ruleCount||0),1),e[6]||(e[6]=t("div",{class:"stat-label"},"规则数",-1))])]),t("div",Be,[o(x,{type:"primary",icon:c(te),onClick:V(N=>b(a),["stop"])},{default:n(()=>e[7]||(e[7]=[g(" 开始配置 ")])),_:2,__:[7]},1032,["icon","onClick"]),o(x,{icon:c(se),onClick:V(N=>O(a),["stop"])},{default:n(()=>e[8]||(e[8]=[g(" 查看详情 ")])),_:2,__:[8]},1032,["icon","onClick"])])])]),_:2},1032,["onClick"]))),128))]))])),[[j,C.value]]),k.value.length>0?(d(),p("div",be,[o(U,{"current-page":m.value,"onUpdate:currentPage":e[1]||(e[1]=a=>m.value=a),"page-size":S.value,"onUpdate:pageSize":e[2]||(e[2]=a=>S.value=a),total:B.value,"page-sizes":[12,24,36,48],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:q,onCurrentChange:E},null,8,["current-page","page-size","total"])])):J("",!0)])}}},Ve=P(xe,[["__scopeId","data-v-6f35d611"]]);export{Ve as default};
