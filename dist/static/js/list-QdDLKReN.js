import{_ as G,a as H,r as u,z as P,o as K,h as i,G as R,d as p,e as d,j as t,H as Y,m as Z,i as o,n as c,ah as A,l as z,K as J,L as Q,k as n,q as g,t as l,Z as W,aF as X,aG as ee,s as L,ax as te,aH as ae,au as se,V}from"./index-CwdKQqOf.js";import{w as oe}from"./bom-DdrUuB8x.js";const ne={class:"configurator-list"},le={class:"list-header"},ie={class:"header-right"},re={class:"bom-list"},de={key:1,class:"bom-cards"},ce={class:"card-header"},ue={class:"bom-title"},_e={class:"card-body"},pe={class:"bom-desc"},ve={class:"bom-info"},me={class:"info-item"},fe={class:"info-item"},he={class:"info-item"},ge={class:"bom-stats"},Ce={class:"stat-item"},ye={class:"stat-value"},Se={class:"stat-item"},ke={class:"stat-value"},we={class:"stat-item"},Me={class:"stat-value"},Be={class:"card-actions"},xe={key:0,class:"pagination"},be={__name:"list",setup(Ne){const M=H(),v=u(""),C=u(!1),y=u([]),m=u(1),S=u(12),B=u(0),k=P(()=>{let a=y.value;if(v.value){const e=v.value.toLowerCase();a=a.filter(_=>{var f,r,h;return((f=_.bomName)==null?void 0:f.toLowerCase().includes(e))||((r=_.bomCode)==null?void 0:r.toLowerCase().includes(e))||((h=_.remark)==null?void 0:h.toLowerCase().includes(e))})}return a}),$=a=>{if(!a)return"-";const e=new Date(a);return`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`},w=async()=>{C.value=!0;try{const a=await oe({pageNum:m.value,pageSize:S.value,bomStatus:"1"});y.value=a.rows||[],B.value=a.total||0,y.value.forEach(e=>{e.nodeCount=e.nodeCount||Math.floor(Math.random()*20)+5,e.attributeCount=e.attributeCount||Math.floor(Math.random()*30)+10,e.ruleCount=e.ruleCount||Math.floor(Math.random()*15)+3})}catch(a){console.error("加载BOM列表失败:",a),V.error("加载BOM列表失败")}finally{C.value=!1}},D=()=>{m.value=1},I=a=>{if(a.bomStatus!=="1"){V.warning("该BOM方案已禁用，无法配置");return}x(a)},x=a=>{M.push({path:`/cpq/configurator/${a.bomId}`,query:{bomName:a.bomName}})},O=a=>{M.push({path:"/cpq/bom/manage",query:{bomId:a.bomId,bomName:a.bomName}})},q=()=>{w()},E=()=>{w()};return K(()=>{w()}),(a,e)=>{const _=i("el-input"),f=i("el-empty"),r=i("el-icon"),h=i("el-tag"),F=i("el-text"),b=i("el-button"),T=i("el-card"),U=i("el-pagination"),j=R("loading");return d(),p("div",ne,[t("div",le,[e[3]||(e[3]=t("div",{class:"header-left"},[t("h2",null,"产品配置选型"),t("p",{class:"header-desc"},"选择一个BOM方案开始配置")],-1)),t("div",ie,[o(_,{modelValue:v.value,"onUpdate:modelValue":e[0]||(e[0]=s=>v.value=s),placeholder:"搜索BOM方案","prefix-icon":c(A),clearable:"",style:{width:"300px"},onInput:D},null,8,["modelValue","prefix-icon"])])]),Y((d(),p("div",re,[k.value.length===0?(d(),z(f,{key:0,description:"暂无BOM方案"})):(d(),p("div",de,[(d(!0),p(J,null,Q(k.value,s=>(d(),z(T,{key:s.bomId,class:"bom-card",shadow:"hover",onClick:N=>I(s)},{header:n(()=>[t("div",ce,[t("div",ue,[o(r,null,{default:n(()=>[o(c(se))]),_:1}),t("span",null,l(s.bomName),1)]),o(h,{type:s.bomStatus==="1"?"success":"info",size:"small"},{default:n(()=>[g(l(s.bomStatus==="1"?"启用":"禁用"),1)]),_:2},1032,["type"])])]),default:n(()=>[t("div",_e,[t("div",pe,[o(F,{type:"info","line-clamp":"2"},{default:n(()=>[g(l(s.remark||"暂无描述"),1)]),_:2},1024)]),t("div",ve,[t("div",me,[o(r,null,{default:n(()=>[o(c(W))]),_:1}),t("span",null,"编码："+l(s.bomCode),1)]),t("div",fe,[o(r,null,{default:n(()=>[o(c(X))]),_:1}),t("span",null,"目录："+l(s.catalogName||"-"),1)]),t("div",he,[o(r,null,{default:n(()=>[o(c(ee))]),_:1}),t("span",null,"创建时间："+l($(s.createTime)),1)])]),t("div",ge,[t("div",Ce,[t("div",ye,l(s.nodeCount||0),1),e[4]||(e[4]=t("div",{class:"stat-label"},"节点数",-1))]),t("div",Se,[t("div",ke,l(s.attributeCount||0),1),e[5]||(e[5]=t("div",{class:"stat-label"},"属性数",-1))]),t("div",we,[t("div",Me,l(s.ruleCount||0),1),e[6]||(e[6]=t("div",{class:"stat-label"},"规则数",-1))])]),t("div",Be,[o(b,{type:"primary",icon:c(te),onClick:L(N=>x(s),["stop"])},{default:n(()=>e[7]||(e[7]=[g(" 开始配置 ")])),_:2,__:[7]},1032,["icon","onClick"]),o(b,{icon:c(ae),onClick:L(N=>O(s),["stop"])},{default:n(()=>e[8]||(e[8]=[g(" 查看详情 ")])),_:2,__:[8]},1032,["icon","onClick"])])])]),_:2},1032,["onClick"]))),128))]))])),[[j,C.value]]),k.value.length>0?(d(),p("div",xe,[o(U,{"current-page":m.value,"onUpdate:currentPage":e[1]||(e[1]=s=>m.value=s),"page-size":S.value,"onUpdate:pageSize":e[2]||(e[2]=s=>S.value=s),total:B.value,"page-sizes":[12,24,36,48],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:q,onCurrentChange:E},null,8,["current-page","page-size","total"])])):Z("",!0)])}}},Ve=G(be,[["__scopeId","data-v-40f233ff"]]);export{Ve as default};
