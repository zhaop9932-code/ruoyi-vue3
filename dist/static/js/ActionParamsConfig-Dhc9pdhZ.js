import{_ as al,r as m,g as le,H as fe,a as _,c as p,o as i,m as x,k as T,b as l,w as t,l as f,e as n,f as y,ay as ul,F as L,az as ol,t as $,aA as ye,K as H,n as be,E as Ae}from"./index-DgigFOm-.js";import te from"./AttributeSelector-CyYPhvVA.js";import re from"./NodeSelector-DEupmx4h.js";import{e as h,b as nl,g as $e,T as ge}from"./actionConfig-C-hhf0v-.js";import{l as il}from"./superBomStructure-C2O6seWy.js";import{getSuperBomVariableByBomId as rl}from"./superBomVariable-_jqz_F6y.js";import"./bom-CjuVRwkz.js";import"./superBomDynamicAttribute-6n4Uab6m.js";import"./superBomProductRelation-c5nmns4w.js";import"./index-DAib79Lj.js";const sl={class:"action-params-config"},dl={style:{"font-size":"13px"}},ml={style:{"font-size":"12px"}},pl={style:{"max-width":"300px"}},cl={key:0},vl={key:1},fl={style:{"font-size":"12px"}},yl={key:2,style:{"margin-top":"10px"}},bl={key:3,style:{"margin-top":"10px"}},$l={style:{"font-size":"12px"}},gl={key:4,style:{"margin-top":"10px"}},Vl={style:{"font-size":"12px"}},_l={style:{"margin-top":"10px"}},xl={key:0,style:{"margin-top":"10px"}},hl={style:{"font-size":"12px"}},Cl={key:1,style:{"margin-top":"10px"}},Sl={style:{"font-size":"12px"}},wl={key:13,class:"no-params-hint"},kl={style:{margin:"0",background:"#f5f7fa",padding:"10px","border-radius":"4px"}},Il={class:"attribute-dialog-content"},Tl={class:"attribute-dialog-left"},ql={class:"attribute-dialog-right"},Al={class:"card-header"},Ul={key:0,class:"selected-node-info"},Nl={key:1,class:"no-selection-hint"},Ml={class:"attribute-dialog-content"},Pl={class:"attribute-dialog-left"},El={class:"attribute-dialog-right"},zl={class:"card-header"},Ll={key:0,class:"selected-node-info"},Rl={key:1,class:"no-selection-hint"},Dl={class:"attribute-dialog-content"},Ol={class:"attribute-dialog-left",style:{flex:"1"}},Fl={class:"variable-option-content"},Bl={class:"variable-option-code"},Wl={class:"variable-option-desc"},Hl={key:0,class:"no-selection-hint"},Yl={class:"dialog-footer"},Jl={class:"attribute-dialog-content"},Gl={class:"attribute-dialog-left"},Kl={class:"attribute-dialog-right"},jl={class:"card-header"},Ql={key:0,class:"selected-node-info"},Xl={key:1,class:"no-selection-hint"},Zl={class:"attribute-dialog-content"},et={class:"attribute-dialog-left"},lt={class:"attribute-dialog-right"},tt={class:"card-header"},at={key:0,class:"selected-node-info"},ut={key:1,class:"no-selection-hint"},ot={class:"attribute-dialog-content"},nt={class:"attribute-dialog-left",style:{flex:"1"}},it={class:"variable-option-content"},rt={class:"variable-option-code"},st={class:"variable-option-desc"},dt={key:0,class:"no-selection-hint"},mt={class:"dialog-footer"},pt={__name:"ActionParamsConfig",props:{modelValue:{type:String,default:"{}"},actionType:{type:String,required:!0},targetType:{type:String,default:""},attributeId:{type:[String,Number],default:""},bomId:{type:[String,Number],required:!0}},emits:["update:modelValue","change"],setup(v,{emit:Ue}){const w=v,Ve=Ue,se=()=>{try{return console.log("props.modelValue",w.modelValue),console.log("JSON.parse(props.modelValue || '')",JSON.parse(w.modelValue||"{}")),JSON.parse(w.modelValue||"{}")}catch{return{}}},a=m(se()),Ne=o=>{if(o)if(A.value="",U.value="",N.value="",M.value="",B.value="",o.startsWith("attr.")){const e=o.replace("attr.","");U.value=e,F.value="static"}else if(o.startsWith("dynAttr.")){const e=o.replace("dynAttr.","");M.value=e,F.value="dynamic"}else{const e=P.value.find(V=>V.variableCode===o);e&&(B.value=e.variableId,F.value="variable")}},ae=m(""),ue=m(""),oe=m(""),K=m(""),_e=m(!0),j=m(!1),Q=m(!1),O=m("static"),xe=m("value"),X=m(!1),F=m("static"),A=m(""),U=m(""),N=m(""),M=m(""),P=m([]),he=m([]),R=m(""),Y=m("");m([]);const D=m(""),J=m("");m([]);const Z=m(""),ee=le(()=>{switch(O.value){case"static":return Y.value;case"dynamic":return J.value;case"variable":return Z.value;default:return""}}),de=le(()=>{var o;switch(F.value){case"static":return U.value?`attr.${U.value}`:"";case"dynamic":return M.value?`dynAttr.${M.value}`:"";case"variable":return((o=P.value.find(e=>e.variableId===B.value))==null?void 0:o.variableCode)||"";default:return""}}),B=m(""),Me=m([{var:"${price}",desc:"节点价格",example:"${price} * 0.9"},{var:"${quantity}",desc:"节点数量",example:"${price} * ${quantity}"},{var:"${totalPrice}",desc:"节点总价",example:"${totalPrice} + ${shipping}"},{var:"${weight}",desc:"节点重量",example:"${weight} * ${quantity}"},{var:"${attr.xxx}",desc:"节点静态属性值",example:"${attr.width} * ${attr.height}"},{var:"${dynAttr.xxx}",desc:"节点动态属性值",example:"${dynAttr.dynamicPrice} * 0.9"},{var:"${var.xxx}",desc:"自定义变量",example:"${var.discount} / 100"},{var:"${parent.price}",desc:"父节点价格",example:"${parent.price} + ${price}"},{var:"${root.price}",desc:"根节点价格",example:"${root.price} * 0.05"},{var:"${system.today}",desc:"当前日期",example:"${system.today} > ${attr.validUntil}"},{var:"${system.now}",desc:"当前时间戳",example:"${system.now} - ${var.createdAt}"},{var:"${count}",desc:"节点数量",example:"${count} > 10 ? ${price} * 0.9 : ${price}"}]),Pe=m([{func:"Math.max(a, b, ...)",desc:"返回最大值",example:"Math.max(${price}, ${attr.costPrice}, 100)"},{func:"Math.min(a, b, ...)",desc:"返回最小值",example:"Math.min(${price}, 1000, ${var.maxPrice})"},{func:"Math.round(x)",desc:"四舍五入",example:"Math.round(${price} * 0.9)"},{func:"Math.floor(x)",desc:"向下取整",example:"Math.floor(${price} / 10) * 10"},{func:"Math.ceil(x)",desc:"向上取整",example:"Math.ceil(${price} / 10) * 10"},{func:"Math.abs(x)",desc:"绝对值",example:"Math.abs(${price} - ${cost})"},{func:"Math.pow(x, y)",desc:"x的y次方",example:"Math.pow(${base}, 2)"},{func:"Math.sqrt(x)",desc:"平方根",example:"Math.sqrt(${attr.area})"},{func:"Math.PI",desc:"圆周率",example:"Math.PI * ${attr.radius} * ${attr.radius}"},{func:"Math.random()",desc:"随机数(0-1)",example:"Math.floor(Math.random() * 100)"},{func:"Math.sin(x)",desc:"正弦值",example:"Math.sin(${attr.angle})"},{func:"Math.cos(x)",desc:"余弦值",example:"Math.cos(${attr.angle})"},{func:"&&",desc:"逻辑与",example:"${quantity} > 10 && ${price} > 100"},{func:"||",desc:"逻辑或",example:'${attr.color} === "red" || ${attr.color} === "blue"'},{func:"!",desc:"逻辑非",example:"!${attr.isAvailable}"},{func:"? :",desc:"三元运算符",example:"${quantity} < 10 ? ${price} : ${price} * 0.9"},{func:"===",desc:"等于",example:'${attr.status} === "active"'},{func:"!==",desc:"不等于",example:'${attr.status} !== "disabled"'},{func:">",desc:"大于",example:"${quantity} > 10"},{func:"<",desc:"小于",example:"${price} < 100"},{func:">=",desc:"大于等于",example:"${quantity} >= 10"},{func:"<=",desc:"小于等于",example:"${price} <= 1000"},{func:"length",desc:"字符串长度",example:"${attr.name}.length > 10"},{func:"includes()",desc:"包含字符串",example:'${attr.name}.includes("VIP")'},{func:"startsWith()",desc:"以字符串开头",example:'${attr.sku}.startsWith("A-")'},{func:"endsWith()",desc:"以字符串结尾",example:'${attr.fileName}.endsWith(".pdf")'},{func:"toUpperCase()",desc:"转换为大写",example:"${attr.code}.toUpperCase()"},{func:"toLowerCase()",desc:"转换为小写",example:"${attr.code}.toLowerCase()"},{func:"trim()",desc:"去除首尾空格",example:"${attr.name}.trim().length > 0"},{func:"Array.isArray()",desc:"是否为数组",example:"Array.isArray(${attr.options})"},{func:"length",desc:"数组长度",example:"${attr.options}.length > 0"},{func:"includes()",desc:"数组包含元素",example:'${attr.options}.includes("option1")'},{func:"if(condition, trueValue, falseValue)",desc:"条件判断",example:"if(${quantity} > 10, ${price} * 0.9, ${price})"},{func:"switch(value, cases)",desc:"多条件判断",example:'switch(${attr.size}, {"S": 10, "M": 15, "L": 20})'},{func:"sum(path)",desc:"求和",example:'sum("${children.price}")'},{func:"avg(path)",desc:"平均值",example:'avg("${children.price}")'},{func:"count(path)",desc:"计数",example:'count("${children}")'},{func:"min(path)",desc:"求最小值",example:'min("${children.price}")'},{func:"max(path)",desc:"求最大值",example:'max("${children.price}")'},{func:"exists(path)",desc:"是否存在",example:'exists("${attr.customField}")'},{func:"isEmpty(value)",desc:"是否为空",example:"isEmpty(${attr.description})"},{func:"formatNumber(value, decimals)",desc:"格式化数字",example:"formatNumber(${price}, 2)"},{func:"formatCurrency(value, currency)",desc:"格式化货币",example:'formatCurrency(${price}, "CNY")'},{func:"calculateTax(base, rate)",desc:"计算税费",example:"calculateTax(${price}, 0.13)"},{func:"calculateDiscount(base, discount)",desc:"计算折扣",example:"calculateDiscount(${price}, ${var.discount})"}]),Ee=m([{title:"计算折扣后价格（9折）",formula:"${price} * 0.9"},{title:"计算总价（价格 × 数量）",formula:"${price} * ${quantity}"},{title:"计算最低价格（不低于成本价）",formula:"Math.max(${price} * 0.9, ${attr.costPrice})"},{title:"阶梯价格（数量越多单价越低）",formula:"${quantity} < 10 ? ${price} : (${quantity} < 100 ? ${price} * 0.9 : ${price} * 0.8)"},{title:"计算面积（长×宽）",formula:"${attr.length} * ${attr.width}"},{title:"条件判断（VIP客户额外95折）",formula:"${attr.isVip} ? (${price} * 0.9 * 0.95) : (${price} * 0.9)"},{title:"多条件组合（数量+VIP+日期）",formula:"${quantity} > 50 && ${attr.isVip} && ${system.today} < ${attr.promotionEnd} ? ${price} * 0.8 : (${quantity} > 10 ? ${price} * 0.9 : ${price})"},{title:"计算税费（13%增值税）",formula:"${price} * 1.13"},{title:"计算运费（重量×单价+首重）",formula:"${weight} > 1 ? (${weight} * ${var.shippingRate} + ${var.baseShipping}) : ${var.baseShipping}"},{title:"动态价格（基于属性值）",formula:'${attr.material} === "steel" ? ${price} * 1.2 : (${attr.material} === "aluminum" ? ${price} * 1.1 : ${price})'},{title:"计算总分（多属性加权）",formula:"${attr.quality} * 0.4 + ${attr.price} * 0.3 + ${attr.deliveryTime} * 0.3"},{title:"字符串条件判断",formula:'${attr.sku}.startsWith("VIP-") ? ${price} * 0.85 : ${price}'},{title:"父节点价格影响",formula:"${parent.price} > 1000 ? ${price} * 0.95 : ${price}"},{title:"数组条件判断",formula:'${attr.options}.includes("premium") ? ${price} + 50 : ${price}'},{title:"日期比较",formula:"${system.today} > ${attr.validFrom} && ${system.today} < ${attr.validUntil} ? ${price} : ${price} * 1.1"},{title:"求和与计数",formula:'sum("${children.price}") + ${var.handlingFee}'},{title:"格式化输出",formula:"formatNumber(${price} * 1.13, 2)"},{title:"计算折扣链",formula:"${price} * (1 - ${var.baseDiscount}) * (1 - ${attr.additionalDiscount})"},{title:"库存判断",formula:"${attr.stock} > ${quantity} ? ${price} : ${price} * 1.05"},{title:"复杂条件嵌套",formula:"${quantity} > 10 ? (${attr.isVip} ? ${price} * 0.85 : ${price} * 0.9) : (${attr.isVip} ? ${price} * 0.9 : ${price})"}]),ze=le(()=>[h.IS_ENABLE,h.IS_SHOW,h.IS_REQUIRED,h.RESET].includes(w.actionType)),Le=le(()=>nl(w.actionType,w.targetType)),Ce=le(()=>{var V,r,b;let o="";if(((V=a.value)==null?void 0:V.settingType)==="formula"&&((r=a.value)!=null&&r.value))o=a.value.value;else if(w.actionType===h.CALCULATION&&((b=a.value)!=null&&b.formula))o=a.value.formula;else return"";let e=o;return e=e.replace(/\$\{attr\.(\w+)\}/g,(C,s)=>`静态属性.${{"01":"长度","02":"宽度","03":"高度","04":"颜色","05":"材质","06":"重量","07":"成本价"}[s]||s}`),e=e.replace(/\$\{dynAttr\.(\w+)\}/g,(C,s)=>`动态属性.${{d01:"动态价格",d02:"库存",d03:"促销价"}[s]||s}`),e=e.replace(/\$\{var\.(\w+)\}/g,(C,s)=>{const k=P.value.find(c=>c.variableCode===s);return`变量.${(k==null?void 0:k.variableName)||s}`}),e=e.replace(/\$\{system\.(\w+)\}/g,(C,s)=>`系统.${{today:"当前日期",now:"当前时间戳"}[s]||s}`),e=e.replace(/\$\{price\}/g,"价格"),e=e.replace(/\$\{quantity\}/g,"数量"),e=e.replace(/\$\{totalPrice\}/g,"总价"),e=e.replace(/\$\{weight\}/g,"重量"),e=e.replace(/\$\{count\}/g,"节点数量"),e=e.replace(/\$\{parent\.(\w+)\}/g,(C,s)=>`父节点.${s}`),e=e.replace(/\$\{root\.(\w+)\}/g,(C,s)=>`根节点.${s}`),e}),d=()=>{const o=JSON.stringify(a.value);Ve("update:modelValue",o),Ve("change",o)},Se=()=>{if(ae.value="",ue.value="",!a.value||!("minSelect"in a.value)||!("maxSelect"in a.value))return!1;const{minSelect:o,maxSelect:e}=a.value;return o>e?(ae.value="不能大于最多选择数量",ue.value="不能小于最少选择数量",!1):o<0?(ae.value="不能为负数",!1):e<1?(ue.value="不能小于1",!1):(d(),!0)},me=()=>{if(oe.value="",!a.value||!("type"in a.value)||!("value"in a.value))return!1;const{type:o,value:e}=a.value;if(o==="percentage"){if(e<0||e>1)return oe.value="百分比应在0-1之间（0.9=90%=9折）",!1}else if(o==="fixed"&&e<0)return oe.value="固定金额不能为负数",!1;return d(),!0},Re=()=>{if(!a.value)return"请先配置满减参数";const{conditionType:o,conditionValue:e,reduceType:V,reduceValue:r,isLoop:b}=a.value||{};if(!e||!r)return"请先配置条件值和减额值";const C=e*2.5;if(b){const s=Math.floor(C/e);if(V==="fixed")return`优惠 ${s} 次，共减 ${s*r} 元`;{const k=s*r;return`优惠 ${s} 次，共减 ${k}%`}}else return C>=e?V==="fixed"?`优惠 1 次，减 ${r} 元`:`优惠 1 次，减 ${r}%`:"未达到满减条件"},De=o=>{a.value.formula!==void 0?a.value.formula=o:a.value.value=o,j.value=!1,pe()},we=async()=>{if(w.bomId)try{const o=await il(w.bomId);o.code===200&&o.data&&(he.value=o.data)}catch(o){console.error("加载BOM结构树失败:",o)}},ne=o=>{if(!o)return"";const e=V=>{for(const r of V){if(r.bomStructureId==o)return r.nodeName||"未知节点";if(r.children&&r.children.length>0){const b=e(r.children);if(b)return b}}return""};return e(he.value)},Oe=o=>{R.value=o,Y.value=""},Fe=o=>{D.value=o,J.value=""},Be=o=>{Y.value=o},We=o=>{J.value=o},He=o=>{Z.value=o},ke=()=>{R.value="",Y.value="",D.value="",J.value="",Z.value="",O.value="static"},Ye=()=>{if(!ee.value)return;let o="";if(O.value==="static")o=`\${attr.${ee.value}}`;else if(O.value==="dynamic")o=`\${dynAttr.${ee.value}}`;else if(O.value==="variable"){const e=P.value.find(V=>V.variableId===ee.value);e&&(o=`\${var.${e.variableCode}}`)}o&&(W(o,xe.value),Q.value=!1,ke())},Je=async()=>{await Ie(),we(),X.value=!0},Ie=async()=>{if(w.bomId)try{const o=await rl(w.bomId);o.code===200&&o.data&&(P.value=o.data,Ne(a.value.resultStorage))}catch(o){console.error("加载变量列表失败:",o),Ae.error("加载变量列表失败")}},Ge=o=>{A.value=o,U.value=""},Ke=o=>{U.value=o},je=o=>{N.value=o,M.value=""},Qe=o=>{M.value=o},Xe=o=>{B.value=o},Ze=()=>{de.value&&(a.value.resultStorage=de.value,d(),X.value=!1,A.value="",U.value="",N.value="",M.value="",B.value="",F.value="static")},W=(o,e="value")=>{if(o==="${attr.}"){if(!w.bomId){Ae.warning("BOM ID为空，无法加载节点数据");return}xe.value=e,Q.value=!0,we(),Ie();return}e==="formula"?a.value.formula?a.value.formula+=o:a.value.formula=o:a.value.value?a.value.value+=o:a.value.value=o,d()},pe=()=>{K.value="";const o=a.value.formula;if(!o)return d(),!0;const e=o.match(/[\(\)]/g)||[],V=e.filter(b=>b==="(").length,r=e.filter(b=>b===")").length;return V!==r?(K.value="括号不匹配",!1):!o.includes("${")&&!o.match(/^\d+$/)?(K.value="公式中应包含至少一个变量引用（如 ${price}）或为纯数字",!1):(d(),!0)},Te=()=>{try{if(!a.value.formula)return"请输入公式";let o=a.value.formula.replace(/\$\{price\}/g,"100").replace(/\$\{quantity\}/g,"5").replace(/\$\{attr\.\w+\}/g,"10").replace(/\$\{var\.\w+\}/g,"20").replace(/\$\{cost\}/g,"80").replace(/\$\{costPrice\}/g,"80");const e=new Function("return "+o)();return typeof e=="number"?e.toFixed(2):"计算错误"}catch(o){return"公式语法错误: "+o.message}};return fe(()=>[w.actionType,w.targetType],([o,e],V)=>{const[r,b]=V||[];if(_e.value){const C=se();if(Object.keys(C).length>0)a.value=C;else{const s=$e(o,e);a.value={...s}}d(),_e.value=!1}else if(o!==r){const C=$e(o,e);a.value={...C},d()}else if(e!==b&&(JSON.stringify(a.value)==="{}"||!a.value||Object.keys(a.value).length===0)){const s=$e(o,e);a.value={...s},d()}},{immediate:!0}),fe(()=>a.value.type,o=>{w.actionType===h.APPLY_DISCOUNT&&(o==="percentage"?a.value.value=.9:a.value.value=0,me())}),fe(()=>w.modelValue,o=>{a.value=se()}),(o,e)=>{const V=_("el-switch"),r=_("el-form-item"),b=_("el-input"),C=_("el-icon"),s=_("el-alert"),k=_("el-input-number"),c=_("el-col"),S=_("el-row"),g=_("el-option"),E=_("el-select"),el=_("el-tooltip"),ie=_("el-space"),I=_("el-button"),ll=_("el-empty"),G=_("el-table-column"),qe=_("el-table"),z=_("el-tab-pane"),q=_("el-card"),ce=_("el-tabs"),ve=_("el-dialog");return i(),p("div",sl,[ze.value?(i(),x(r,{key:0,label:"动作参数",required:""},{default:t(()=>[l(V,{modelValue:a.value.value,"onUpdate:modelValue":e[0]||(e[0]=u=>a.value.value=u),onChange:d,"active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})):v.actionType===f(h).IS_RECOMMEND?(i(),x(r,{key:1,label:"推荐内容",required:""},{default:t(()=>[l(b,{modelValue:a.value.value,"onUpdate:modelValue":e[1]||(e[1]=u=>a.value.value=u),onInput:d,placeholder:"请输入推荐内容（如：推荐节点、推荐属性、推荐产品等）",style:{width:"100%"}},null,8,["modelValue"])]),_:1})):v.actionType===f(h).LINK_SELECT&&v.targetType===f(ge).NODE_PRODUCT?(i(),x(r,{key:2,label:"动作参数",required:""},{default:t(()=>[l(V,{modelValue:a.value.value,"onUpdate:modelValue":e[2]||(e[2]=u=>a.value.value=u),onChange:d,"active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})):v.actionType===f(h).LINK_SELECT&&(v.targetType===f(ge).NODE_STATIC_ATTR_VALUE||v.targetType===f(ge).NODE_DYNAMIC_ATTR_VALUE)?(i(),x(r,{key:3,label:"动作参数",required:""},{default:t(()=>[v.attributeId?(i(),x(te,{key:1,modelValue:a.value.value,"onUpdate:modelValue":e[3]||(e[3]=u=>a.value.value=u),"attribute-type":"attributeValue","attribute-id":v.attributeId,label:"",placeholder:"请选择属性下属性值",multiple:!0,onChange:d},null,8,["modelValue","attribute-id"])):(i(),x(s,{key:0,type:"warning",closable:!1,style:{"margin-bottom":"10px"}},{title:t(()=>[n("span",dl,[l(C,{style:{"vertical-align":"middle"}},{default:t(()=>[l(f(ul))]),_:1}),e[53]||(e[53]=y(" 请先在上方选择节点和属性，然后再配置要联动选中的属性值 "))])]),_:1}))]),_:1})):v.actionType===f(h).MULTIPLE_SELECT?(i(),x(S,{key:4,gutter:20},{default:t(()=>[l(c,{span:12},{default:t(()=>[l(r,{label:"最少选择数量",required:"",error:ae.value},{default:t(()=>[l(k,{modelValue:a.value.minSelect,"onUpdate:modelValue":e[4]||(e[4]=u=>a.value.minSelect=u),onChange:Se,min:0,max:a.value.maxSelect||999,step:1,style:{width:"100%"},placeholder:"请输入最少选择数量"},null,8,["modelValue","max"])]),_:1},8,["error"])]),_:1}),l(c,{span:12},{default:t(()=>[l(r,{label:"最多选择数量",required:"",error:ue.value},{default:t(()=>[l(k,{modelValue:a.value.maxSelect,"onUpdate:modelValue":e[5]||(e[5]=u=>a.value.maxSelect=u),onChange:Se,min:a.value.minSelect||1,step:1,style:{width:"100%"},placeholder:"请输入最多选择数量"},null,8,["modelValue","min"])]),_:1},8,["error"])]),_:1})]),_:1})):v.actionType===f(h).APPLY_DISCOUNT?(i(),p(L,{key:5},[l(S,{gutter:20},{default:t(()=>[l(c,{span:8},{default:t(()=>[l(r,{label:"折扣类型",required:""},{default:t(()=>[l(E,{modelValue:a.value.type,"onUpdate:modelValue":e[6]||(e[6]=u=>a.value.type=u),onChange:me,style:{width:"100%"}},{default:t(()=>[l(g,{label:"百分比",value:"percentage"}),l(g,{label:"固定金额",value:"fixed"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(c,{span:8},{default:t(()=>[l(r,{label:"折扣值",required:"",error:oe.value},{default:t(()=>[l(k,{modelValue:a.value.value,"onUpdate:modelValue":e[7]||(e[7]=u=>a.value.value=u),onChange:me,min:0,max:a.value.type==="percentage"?1:void 0,step:a.value.type==="percentage"?.01:1,precision:a.value.type==="percentage"?2:0,style:{width:"100%"},placeholder:a.value.type==="percentage"?"0-1之间":"折扣金额"},ol({_:2},[a.value.type==="percentage"?{name:"append",fn:t(()=>[y($((a.value.value*100).toFixed(0))+"% ",1)]),key:"0"}:{name:"append",fn:t(()=>[e[54]||(e[54]=y(" 元 "))]),key:"1"}]),1032,["modelValue","max","step","precision","placeholder"])]),_:1},8,["error"])]),_:1}),l(c,{span:8},{default:t(()=>[l(r,{label:"是否叠加",required:""},{default:t(()=>[l(V,{modelValue:a.value.isStackable,"onUpdate:modelValue":e[8]||(e[8]=u=>a.value.isStackable=u),onChange:d,"active-text":"是","inactive-text":"否"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(S,{gutter:20},{default:t(()=>[l(c,{span:24},{default:t(()=>[l(s,{type:"info",closable:!1,style:{"margin-top":"10px"}},{title:t(()=>[n("span",ml,$(a.value.type==="percentage"?`百分比折扣：原价100元，折后${(100*a.value.value).toFixed(2)}元（${(a.value.value*100).toFixed(0)}%）`:`固定金额折扣：原价100元，折后${(100-a.value.value).toFixed(2)}元`),1)]),_:1})]),_:1})]),_:1})],64)):v.actionType===f(h).APPLY_FULL_REDUCTION?(i(),p(L,{key:6},[l(S,{gutter:20},{default:t(()=>[l(c,{span:12},{default:t(()=>[l(r,{label:"满减条件类型",required:""},{default:t(()=>[l(E,{modelValue:a.value.conditionType,"onUpdate:modelValue":e[9]||(e[9]=u=>a.value.conditionType=u),onChange:d,style:{width:"100%"}},{default:t(()=>[l(g,{label:"满金额",value:"amount"}),l(g,{label:"满数量",value:"quantity"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(c,{span:12},{default:t(()=>[l(r,{label:"条件值",required:""},{default:t(()=>[l(k,{modelValue:a.value.conditionValue,"onUpdate:modelValue":e[10]||(e[10]=u=>a.value.conditionValue=u),onChange:d,min:0,step:1,style:{width:"100%"},placeholder:"请输入条件值"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(S,{gutter:20},{default:t(()=>[l(c,{span:12},{default:t(()=>[l(r,{label:"减额类型",required:""},{default:t(()=>[l(E,{modelValue:a.value.reduceType,"onUpdate:modelValue":e[11]||(e[11]=u=>a.value.reduceType=u),onChange:d,style:{width:"100%"}},{default:t(()=>[l(g,{label:"固定金额",value:"fixed"}),l(g,{label:"百分比",value:"percentage"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(c,{span:12},{default:t(()=>[l(r,{label:"减额值",required:""},{default:t(()=>[l(k,{modelValue:a.value.reduceValue,"onUpdate:modelValue":e[12]||(e[12]=u=>a.value.reduceValue=u),onChange:d,min:0,step:1,style:{width:"100%"},placeholder:"请输入减额值"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(S,{gutter:20},{default:t(()=>[l(c,{span:12},{default:t(()=>[l(r,{label:"是否循环满减",required:""},{default:t(()=>[l(ie,null,{default:t(()=>[l(V,{modelValue:a.value.isLoop,"onUpdate:modelValue":e[13]||(e[13]=u=>a.value.isLoop=u),onChange:d,"active-text":"是","inactive-text":"否"},null,8,["modelValue"]),l(el,{placement:"top"},{content:t(()=>[n("div",pl,[e[57]||(e[57]=n("p",null,[n("strong",null,"循环满减说明：")],-1)),a.value.conditionType==="amount"?(i(),p("p",cl,e[55]||(e[55]=[y(" 示例：满1000减100"),n("br",null,null,-1),y(" • 开启循环：订单2500元，减2次=200元"),n("br",null,null,-1),y(" • 关闭循环：订单2500元，减1次=100元 ")]))):(i(),p("p",vl,e[56]||(e[56]=[y(" 示例：满10件减50"),n("br",null,null,-1),y(" • 开启循环：订单25件，减2次=100元"),n("br",null,null,-1),y(" • 关闭循环：订单25件，减1次=50元 ")])))])]),default:t(()=>[l(C,{style:{cursor:"help"}},{default:t(()=>[l(f(ye))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a.value.conditionValue&&a.value.reduceValue?(i(),x(S,{key:0,gutter:20},{default:t(()=>[l(c,{span:24},{default:t(()=>[l(s,{type:"info",closable:!1,style:{"margin-top":"10px"}},{title:t(()=>[n("span",fl," 计算示例： "+$(a.value.conditionType==="amount"?"订单金额":"订单数量")+" "+$(a.value.conditionValue*2.5)+" "+$(a.value.conditionType==="amount"?"元":"件")+"， "+$(a.value.isLoop?"循环":"单次")+"满减， "+$(Re()),1)]),_:1})]),_:1})]),_:1})):T("",!0)],64)):v.actionType===f(h).SET_PRICE?(i(),p(L,{key:7},[l(S,{gutter:20},{default:t(()=>[l(c,{span:12},{default:t(()=>[l(r,{label:"单价设置方式",required:""},{default:t(()=>[l(E,{modelValue:a.value.settingType,"onUpdate:modelValue":e[14]||(e[14]=u=>a.value.settingType=u),onChange:d,style:{width:"100%"}},{default:t(()=>[l(g,{label:"固定价格",value:"fixed"}),l(g,{label:"公式计算",value:"formula"})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(S,{gutter:20},{default:t(()=>[l(c,{span:24},{default:t(()=>[l(r,{label:"单价值/公式",required:"",error:a.value.settingType==="formula"?K.value:""},{default:t(()=>[a.value.settingType==="fixed"?(i(),x(k,{key:0,modelValue:a.value.value,"onUpdate:modelValue":e[15]||(e[15]=u=>a.value.value=u),onChange:d,min:0,step:.01,precision:2,style:{width:"100%"},placeholder:"请输入单价值"},{append:t(()=>e[58]||(e[58]=[y("元")])),_:1},8,["modelValue"])):(i(),x(b,{key:1,modelValue:a.value.value,"onUpdate:modelValue":e[16]||(e[16]=u=>a.value.value=u),onInput:pe,type:"textarea",rows:3,placeholder:"请输入计算公式（支持数学表达式和变量引用）"},null,8,["modelValue"])),a.value.settingType==="formula"?(i(),p("div",yl,[l(ie,{wrap:""},{default:t(()=>[l(I,{size:"small",onClick:e[17]||(e[17]=u=>W("${price}")),icon:f(H)},{default:t(()=>e[59]||(e[59]=[y(" 插入价格 ")])),_:1,__:[59]},8,["icon"]),l(I,{size:"small",onClick:e[18]||(e[18]=u=>W("${quantity}")),icon:f(H)},{default:t(()=>e[60]||(e[60]=[y(" 插入数量 ")])),_:1,__:[60]},8,["icon"]),l(I,{size:"small",onClick:e[19]||(e[19]=u=>W("${attr.}")),icon:f(H)},{default:t(()=>e[61]||(e[61]=[y(" 插入属性 ")])),_:1,__:[61]},8,["icon"]),l(I,{size:"small",onClick:e[20]||(e[20]=u=>j.value=!0),icon:f(ye)},{default:t(()=>e[62]||(e[62]=[y(" 公式帮助 ")])),_:1,__:[62]},8,["icon"])]),_:1})])):T("",!0),a.value.settingType==="formula"&&a.value.value?(i(),p("div",bl,[l(s,{type:"info",closable:!1},{title:t(()=>[n("span",$l,[e[63]||(e[63]=n("strong",null,"公式预览：",-1)),n("span",null,$(Ce.value),1)])]),_:1})])):T("",!0),a.value.settingType==="formula"&&a.value.value?(i(),p("div",gl,[l(s,{type:"info",closable:!1},{title:t(()=>[n("span",Vl,[e[64]||(e[64]=y(" 公式测试（假设 price=100, quantity=5, attr=10）: ")),n("strong",null,$(Te()),1)])]),_:1})])):T("",!0)]),_:1},8,["error"])]),_:1})]),_:1})],64)):v.actionType===f(h).SHOW_MESSAGE?(i(),p(L,{key:8},[l(S,{gutter:20},{default:t(()=>[l(c,{span:8},{default:t(()=>[l(r,{label:"消息级别",required:""},{default:t(()=>[l(E,{modelValue:a.value.level,"onUpdate:modelValue":e[21]||(e[21]=u=>a.value.level=u),onChange:d,style:{width:"100%"}},{default:t(()=>[l(g,{label:"信息",value:"info"}),l(g,{label:"成功",value:"success"}),l(g,{label:"警告",value:"warning"}),l(g,{label:"错误",value:"error"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(c,{span:16},{default:t(()=>[l(r,{label:"消息标题",required:""},{default:t(()=>[l(b,{modelValue:a.value.title,"onUpdate:modelValue":e[22]||(e[22]=u=>a.value.title=u),onInput:d,placeholder:"请输入消息标题"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(S,{gutter:20},{default:t(()=>[l(c,{span:24},{default:t(()=>[l(r,{label:"消息内容",required:""},{default:t(()=>[l(b,{modelValue:a.value.content,"onUpdate:modelValue":e[23]||(e[23]=u=>a.value.content=u),onInput:d,type:"textarea",rows:3,placeholder:"请输入消息内容"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})],64)):v.actionType===f(h).SEND_NOTIFICATION?(i(),p(L,{key:9},[l(S,{gutter:20},{default:t(()=>[l(c,{span:12},{default:t(()=>[l(r,{label:"通知类型",required:""},{default:t(()=>[l(E,{modelValue:a.value.type,"onUpdate:modelValue":e[24]||(e[24]=u=>a.value.type=u),onChange:d,style:{width:"100%"}},{default:t(()=>[l(g,{label:"邮件",value:"email"}),l(g,{label:"短信",value:"sms"}),l(g,{label:"站内信",value:"message"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(c,{span:12},{default:t(()=>[l(r,{label:"接收者",required:""},{default:t(()=>[l(b,{modelValue:a.value.recipient,"onUpdate:modelValue":e[25]||(e[25]=u=>a.value.recipient=u),onInput:d,placeholder:"请输入接收者"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),l(S,{gutter:20},{default:t(()=>[l(c,{span:24},{default:t(()=>[l(r,{label:"通知内容",required:""},{default:t(()=>[l(b,{modelValue:a.value.content,"onUpdate:modelValue":e[26]||(e[26]=u=>a.value.content=u),onInput:d,type:"textarea",rows:3,placeholder:"请输入通知内容"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})],64)):v.actionType===f(h).TRIGGER_WARNING?(i(),x(S,{key:10,gutter:20},{default:t(()=>[l(c,{span:12},{default:t(()=>[l(r,{label:"警告级别",required:""},{default:t(()=>[l(E,{modelValue:a.value.level,"onUpdate:modelValue":e[27]||(e[27]=u=>a.value.level=u),onChange:d,style:{width:"100%"}},{default:t(()=>[l(g,{label:"低",value:"low"}),l(g,{label:"中",value:"medium"}),l(g,{label:"高",value:"high"}),l(g,{label:"严重",value:"critical"})]),_:1},8,["modelValue"])]),_:1})]),_:1}),l(c,{span:12},{default:t(()=>[l(r,{label:"警告消息",required:""},{default:t(()=>[l(b,{modelValue:a.value.message,"onUpdate:modelValue":e[28]||(e[28]=u=>a.value.message=u),onInput:d,placeholder:"请输入警告消息"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})):v.actionType===f(h).CALCULATION?(i(),p(L,{key:11},[l(S,{gutter:20},{default:t(()=>[l(c,{span:24},{default:t(()=>[l(r,{label:"计算公式",required:"",error:K.value},{default:t(()=>[l(b,{modelValue:a.value.formula,"onUpdate:modelValue":e[29]||(e[29]=u=>a.value.formula=u),onInput:pe,type:"textarea",rows:3,placeholder:"请输入计算公式（支持数学表达式和变量引用）"},null,8,["modelValue"]),n("div",_l,[l(ie,{wrap:""},{default:t(()=>[l(I,{size:"small",onClick:e[30]||(e[30]=u=>W("${price}","formula")),icon:f(H)},{default:t(()=>e[65]||(e[65]=[y(" 插入价格 ")])),_:1,__:[65]},8,["icon"]),l(I,{size:"small",onClick:e[31]||(e[31]=u=>W("${quantity}","formula")),icon:f(H)},{default:t(()=>e[66]||(e[66]=[y(" 插入数量 ")])),_:1,__:[66]},8,["icon"]),l(I,{size:"small",onClick:e[32]||(e[32]=u=>W("${attr.}","formula")),icon:f(H)},{default:t(()=>e[67]||(e[67]=[y(" 插入属性 ")])),_:1,__:[67]},8,["icon"]),l(I,{size:"small",onClick:e[33]||(e[33]=u=>j.value=!0),icon:f(ye)},{default:t(()=>e[68]||(e[68]=[y(" 公式帮助 ")])),_:1,__:[68]},8,["icon"])]),_:1})]),a.value.formula?(i(),p("div",xl,[l(s,{type:"info",closable:!1},{title:t(()=>[n("span",hl,[e[69]||(e[69]=n("strong",null,"公式预览：",-1)),n("span",null,$(Ce.value),1)])]),_:1})])):T("",!0),a.value.formula?(i(),p("div",Cl,[l(s,{type:"info",closable:!1},{title:t(()=>[n("span",Sl,[e[70]||(e[70]=y(" 公式测试（假设 price=100, quantity=5, attr=10）: ")),n("strong",null,$(Te()),1)])]),_:1})])):T("",!0)]),_:1},8,["error"])]),_:1})]),_:1}),l(S,{gutter:20},{default:t(()=>[l(c,{span:24},{default:t(()=>[l(r,{label:"计算结果存储到",required:""},{default:t(()=>[l(b,{modelValue:a.value.resultStorage,"onUpdate:modelValue":e[34]||(e[34]=u=>a.value.resultStorage=u),onInput:d,placeholder:"请输入变量名或属性名（如: totalPrice, attr.finalPrice）"},{append:t(()=>[l(I,{type:"primary",size:"small",onClick:Je,icon:f(H)},{default:t(()=>e[71]||(e[71]=[y(" 选择 ")])),_:1,__:[71]},8,["icon"])]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})],64)):v.actionType===f(h).CALL_API?(i(),x(S,{key:12,gutter:20},{default:t(()=>[l(c,{span:24},{default:t(()=>[l(r,{label:"API参数",required:""},{default:t(()=>[l(b,{modelValue:a.value.apiParams,"onUpdate:modelValue":e[35]||(e[35]=u=>a.value.apiParams=u),onInput:d,type:"textarea",rows:4,placeholder:"请输入API参数（JSON格式）"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})):Le.value?(i(),p("div",wl,[l(ll,{description:"该动作类型无需配置参数","image-size":60})])):T("",!0),l(ve,{modelValue:j.value,"onUpdate:modelValue":e[36]||(e[36]=u=>j.value=u),title:"公式编写帮助",width:"700px"},{default:t(()=>[l(ce,null,{default:t(()=>[l(z,{label:"变量引用"},{default:t(()=>[l(qe,{data:Me.value,size:"small","show-header":!0},{default:t(()=>[l(G,{prop:"var",label:"变量",width:"150"}),l(G,{prop:"desc",label:"说明",width:"150"}),l(G,{prop:"example",label:"示例"})]),_:1},8,["data"])]),_:1}),l(z,{label:"数学函数"},{default:t(()=>[l(qe,{data:Pe.value,size:"small","show-header":!0},{default:t(()=>[l(G,{prop:"func",label:"函数",width:"180"}),l(G,{prop:"desc",label:"说明",width:"150"}),l(G,{prop:"example",label:"示例"})]),_:1},8,["data"])]),_:1}),l(z,{label:"示例公式"},{default:t(()=>[l(ie,{direction:"vertical",fill:!0,style:{width:"100%"}},{default:t(()=>[(i(!0),p(L,null,be(Ee.value,(u,tl)=>(i(),x(q,{key:tl,size:"small",shadow:"hover"},{header:t(()=>[n("strong",null,$(u.title),1)]),default:t(()=>[n("pre",kl,$(u.formula),1),l(I,{size:"small",type:"primary",onClick:ct=>De(u.formula),style:{"margin-top":"10px"}},{default:t(()=>e[72]||(e[72]=[y(" 使用此公式 ")])),_:2,__:[72]},1032,["onClick"])]),_:2},1024))),128))]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(ve,{modelValue:Q.value,"onUpdate:modelValue":e[44]||(e[44]=u=>Q.value=u),title:"选择属性",width:"900px",onClose:ke},{footer:t(()=>[n("span",Yl,[l(I,{onClick:e[43]||(e[43]=u=>Q.value=!1)},{default:t(()=>e[78]||(e[78]=[y("取消")])),_:1,__:[78]}),l(I,{type:"primary",onClick:Ye,disabled:!ee.value},{default:t(()=>e[79]||(e[79]=[y("确定")])),_:1,__:[79]},8,["disabled"])])]),default:t(()=>[l(ce,{modelValue:O.value,"onUpdate:modelValue":e[42]||(e[42]=u=>O.value=u)},{default:t(()=>[l(z,{label:"静态属性",name:"static"},{default:t(()=>[n("div",Il,[n("div",Tl,[l(q,{size:"small",class:"node-tree-card"},{header:t(()=>e[73]||(e[73]=[n("div",{class:"card-header"},[n("span",null,"节点树")],-1)])),default:t(()=>[l(re,{modelValue:R.value,"onUpdate:modelValue":e[37]||(e[37]=u=>R.value=u),"bom-id":v.bomId,label:"",placeholder:"请选择节点",multiple:!1,required:!1,onChange:Oe},null,8,["modelValue","bom-id"])]),_:1})]),n("div",ql,[l(q,{size:"small",class:"attribute-list-card"},{header:t(()=>[n("div",Al,[e[74]||(e[74]=n("span",null,"属性列表",-1)),R.value?(i(),p("span",Ul,"(当前节点: "+$(ne(R.value))+")",1)):T("",!0)])]),default:t(()=>[R.value?(i(),x(te,{key:0,modelValue:Y.value,"onUpdate:modelValue":e[38]||(e[38]=u=>Y.value=u),"attribute-type":"static","bom-id":v.bomId,"node-id":R.value,label:"",placeholder:"请选择静态属性",multiple:!1,required:!1,onChange:Be},null,8,["modelValue","bom-id","node-id"])):(i(),p("div",Nl,"请先选择左侧节点"))]),_:1})])])]),_:1}),l(z,{label:"动态属性",name:"dynamic"},{default:t(()=>[n("div",Ml,[n("div",Pl,[l(q,{size:"small",class:"node-tree-card"},{header:t(()=>e[75]||(e[75]=[n("div",{class:"card-header"},[n("span",null,"节点树")],-1)])),default:t(()=>[l(re,{modelValue:D.value,"onUpdate:modelValue":e[39]||(e[39]=u=>D.value=u),"bom-id":v.bomId,label:"",placeholder:"请选择节点",multiple:!1,required:!1,onChange:Fe},null,8,["modelValue","bom-id"])]),_:1})]),n("div",El,[l(q,{size:"small",class:"attribute-list-card"},{header:t(()=>[n("div",zl,[e[76]||(e[76]=n("span",null,"属性列表",-1)),D.value?(i(),p("span",Ll,"(当前节点: "+$(ne(D.value))+")",1)):T("",!0)])]),default:t(()=>[D.value?(i(),x(te,{key:0,modelValue:J.value,"onUpdate:modelValue":e[40]||(e[40]=u=>J.value=u),"attribute-type":"dynamic","bom-id":v.bomId,"node-id":D.value,label:"",placeholder:"请选择动态属性",multiple:!1,required:!1,onChange:We},null,8,["modelValue","bom-id","node-id"])):(i(),p("div",Rl,"请先选择左侧节点"))]),_:1})])])]),_:1}),l(z,{label:"变量",name:"variable"},{default:t(()=>[n("div",Dl,[n("div",Ol,[l(q,{size:"small",class:"attribute-list-card"},{header:t(()=>e[77]||(e[77]=[n("div",{class:"card-header"},[n("span",null,"变量列表")],-1)])),default:t(()=>[l(E,{modelValue:Z.value,"onUpdate:modelValue":e[41]||(e[41]=u=>Z.value=u),placeholder:"请选择变量",style:{width:"100%"},onChange:He},{default:t(()=>[(i(!0),p(L,null,be(P.value,u=>(i(),x(g,{key:u.variableId,label:`${u.variableName} (${u.variableCode})`,value:u.variableId},{default:t(()=>[n("div",Fl,[n("div",null,$(u.variableName),1),n("div",Bl,$(u.variableCode),1),n("div",Wl,$(u.description),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"]),P.value.length===0?(i(),p("div",Hl,"当前BOM下没有可用变量")):T("",!0)]),_:1})])])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),l(ve,{modelValue:X.value,"onUpdate:modelValue":e[52]||(e[52]=u=>X.value=u),title:"选择计算结果存储目标",width:"900px"},{footer:t(()=>[n("span",mt,[l(I,{onClick:e[51]||(e[51]=u=>X.value=!1)},{default:t(()=>e[85]||(e[85]=[y("取消")])),_:1,__:[85]}),l(I,{type:"primary",onClick:Ze,disabled:!de.value},{default:t(()=>e[86]||(e[86]=[y("确定")])),_:1,__:[86]},8,["disabled"])])]),default:t(()=>[l(ce,{modelValue:F.value,"onUpdate:modelValue":e[50]||(e[50]=u=>F.value=u)},{default:t(()=>[l(z,{label:"静态属性",name:"static"},{default:t(()=>[n("div",Jl,[n("div",Gl,[l(q,{size:"small",class:"node-tree-card"},{header:t(()=>e[80]||(e[80]=[n("div",{class:"card-header"},[n("span",null,"节点树")],-1)])),default:t(()=>[l(re,{modelValue:A.value,"onUpdate:modelValue":e[45]||(e[45]=u=>A.value=u),"bom-id":v.bomId,label:"",placeholder:"请选择节点",multiple:!1,required:!1,onChange:Ge},null,8,["modelValue","bom-id"])]),_:1})]),n("div",Kl,[l(q,{size:"small",class:"attribute-list-card"},{header:t(()=>[n("div",jl,[e[81]||(e[81]=n("span",null,"属性列表",-1)),A.value?(i(),p("span",Ql,"(当前节点: "+$(ne(A.value))+")",1)):T("",!0)])]),default:t(()=>[A.value?(i(),x(te,{key:0,modelValue:U.value,"onUpdate:modelValue":e[46]||(e[46]=u=>U.value=u),"attribute-type":"static","bom-id":v.bomId,"node-id":A.value,label:"",placeholder:"请选择静态属性",multiple:!1,required:!1,onChange:Ke},null,8,["modelValue","bom-id","node-id"])):(i(),p("div",Xl,"请先选择左侧节点"))]),_:1})])])]),_:1}),l(z,{label:"动态属性",name:"dynamic"},{default:t(()=>[n("div",Zl,[n("div",et,[l(q,{size:"small",class:"node-tree-card"},{header:t(()=>e[82]||(e[82]=[n("div",{class:"card-header"},[n("span",null,"节点树")],-1)])),default:t(()=>[l(re,{modelValue:N.value,"onUpdate:modelValue":e[47]||(e[47]=u=>N.value=u),"bom-id":v.bomId,label:"",placeholder:"请选择节点",multiple:!1,required:!1,onChange:je},null,8,["modelValue","bom-id"])]),_:1})]),n("div",lt,[l(q,{size:"small",class:"attribute-list-card"},{header:t(()=>[n("div",tt,[e[83]||(e[83]=n("span",null,"属性列表",-1)),N.value?(i(),p("span",at,"(当前节点: "+$(ne(N.value))+")",1)):T("",!0)])]),default:t(()=>[N.value?(i(),x(te,{key:0,modelValue:M.value,"onUpdate:modelValue":e[48]||(e[48]=u=>M.value=u),"attribute-type":"dynamic","bom-id":v.bomId,"node-id":N.value,label:"",placeholder:"请选择动态属性",multiple:!1,required:!1,onChange:Qe},null,8,["modelValue","bom-id","node-id"])):(i(),p("div",ut,"请先选择左侧节点"))]),_:1})])])]),_:1}),l(z,{label:"当前BOM下的变量",name:"variable"},{default:t(()=>[n("div",ot,[n("div",nt,[l(q,{size:"small",class:"attribute-list-card"},{header:t(()=>e[84]||(e[84]=[n("div",{class:"card-header"},[n("span",null,"变量列表")],-1)])),default:t(()=>[l(E,{modelValue:B.value,"onUpdate:modelValue":e[49]||(e[49]=u=>B.value=u),placeholder:"请选择当前BOM下的变量",style:{width:"100%"},onChange:Xe},{default:t(()=>[(i(!0),p(L,null,be(P.value,u=>(i(),x(g,{key:u.variableId,label:`${u.variableName} (${u.variableCode})`,value:u.variableId},{default:t(()=>[n("div",it,[n("div",null,$(u.variableName),1),n("div",rt,$(u.variableCode),1),n("div",st,$(u.description),1)])]),_:2},1032,["label","value"]))),128))]),_:1},8,["modelValue"]),P.value.length===0?(i(),p("div",dt,"当前BOM下没有可用变量")):T("",!0)]),_:1})])])]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])}}},Ct=al(pt,[["__scopeId","data-v-3a1775c8"]]);export{Ct as default};
