import{_ as j,r as S,h as q,a as r,c as y,o as i,b as e,w as l,e as s,F as D,s as H,f as w,t as V,N as A,ag as K,q as E,am as Q,m as v}from"./index-kbfDsxmo.js";import{d as W}from"./vuedraggable.umd-CWWwxWVR.js";import"./sortable.esm-DysyInFf.js";const X={class:"action-config"},Y={class:"card-header"},Z={class:"action-type-buttons"},ee={class:"card-header"},le={class:"action-count"},ae={key:0,class:"empty-actions"},te={class:"action-item"},oe={class:"action-item-header"},de={class:"action-index"},ue={class:"action-item-content"},se={class:"preview-content"},ne={key:0},ce={__name:"RuleActionConfig",props:{modelValue:{type:Array,default:()=>[]},ruleType:{type:String,default:"validation"}},emits:["update:modelValue","update:actions"],setup(C,{emit:M}){const T=C,$=M,u=S([...T.modelValue]),g=S("setProperty"),N=[{label:"设置属性",value:"setProperty"},{label:"添加产品",value:"addProduct"},{label:"删除产品",value:"removeProduct"},{label:"显示消息",value:"showMessage"},{label:"调用API",value:"callApi"},{label:"执行脚本",value:"executeScript"}],O=t=>({setProperty:"设置属性",addProduct:"添加产品",removeProduct:"删除产品",showMessage:"显示消息",callApi:"调用API",executeScript:"执行脚本"})[t]||t,B=t=>({setProperty:"primary",addProduct:"success",removeProduct:"danger",showMessage:"warning",callApi:"info",executeScript:"success"})[t]||"default",z=t=>{g.value=t},J=()=>{const t={id:Date.now(),type:g.value,field:"",value:"",condition:"",sequence:u.value.length+1};u.value.push(t),b()},L=t=>{u.value.splice(t,1),u.value.forEach((d,f)=>{d.sequence=f+1}),b()},F=()=>u.value.length===0?"":u.value.map(t=>{let d="";switch(t.type){case"setProperty":d=`设置 ${t.field} = ${t.value}`;break;case"addProduct":d=`添加产品 ${t.productId}，数量：${t.quantity}`;break;case"removeProduct":d=`删除产品 ${t.productId}`;break;case"showMessage":d=`显示消息：${t.message}（${t.messageType}）`;break;case"callApi":d=`调用API：${t.method} ${t.url}`;break;case"executeScript":d=`执行脚本：${t.script.substring(0,50)}...`;break;default:d=`执行动作：${t.type}`}const f=t.condition?` [条件: ${t.condition}]`:"";return`${t.sequence}. ${d}${f}`}).join(`
`),b=()=>{$("update:modelValue",u.value),$("update:actions",u.value)};return q(u,()=>{b()},{deep:!0}),q(()=>T.modelValue,t=>{JSON.stringify(t)!==JSON.stringify(u.value)&&(u.value=[...t])},{deep:!0}),(t,d)=>{const f=r("el-icon"),h=r("el-button"),U=r("el-card"),x=r("el-empty"),G=r("el-tag"),n=r("el-option"),P=r("el-select"),c=r("el-form-item"),p=r("el-col"),_=r("el-input"),m=r("el-row"),I=r("el-input-number"),R=r("el-form");return i(),y("div",X,[e(U,{class:"action-types"},{header:l(()=>[s("div",Y,[d[2]||(d[2]=s("span",null,"动作类型",-1)),e(h,{type:"primary",size:"small",onClick:J},{default:l(()=>[e(f,null,{default:l(()=>[e(A(K))]),_:1}),d[1]||(d[1]=w(" 添加动作 "))]),_:1,__:[1]})])]),default:l(()=>[s("div",Z,[(i(),y(D,null,H(N,a=>e(h,{key:a.value,type:g.value===a.value?"primary":"default",onClick:k=>z(a.value),size:"small",class:"action-type-btn"},{default:l(()=>[w(V(a.label),1)]),_:2},1032,["type","onClick"])),64))])]),_:1}),e(U,{class:"action-list",shadow:"hover"},{header:l(()=>[s("div",ee,[d[3]||(d[3]=s("span",null,"动作列表",-1)),s("span",le,V(u.value.length)+" 个动作",1)])]),default:l(()=>[u.value.length===0?(i(),y("div",ae,[e(x,{description:"暂无动作"})])):E("",!0),e(A(W),{modelValue:u.value,"onUpdate:modelValue":d[0]||(d[0]=a=>u.value=a),"item-key":"id",handle:".drag-handle","ghost-class":"ghost"},{item:l(({element:a,index:k})=>[s("div",te,[s("div",oe,[e(f,{class:"drag-handle"},{default:l(()=>[e(A(Q))]),_:1}),s("span",de,V(k+1),1),e(G,{type:B(a.type)},{default:l(()=>[w(V(O(a.type)),1)]),_:2},1032,["type"]),e(h,{type:"danger",size:"small",icon:"Delete",onClick:o=>L(k)},null,8,["onClick"])]),s("div",ue,[e(R,{model:a,"label-position":"top","label-width":"80px"},{default:l(()=>[a.type==="setProperty"?(i(),v(m,{key:0,gutter:20},{default:l(()=>[e(p,{span:12},{default:l(()=>[e(c,{label:"属性字段"},{default:l(()=>[e(P,{modelValue:a.field,"onUpdate:modelValue":o=>a.field=o,placeholder:"请选择属性字段"},{default:l(()=>[e(n,{label:"产品价格",value:"productPrice"}),e(n,{label:"产品数量",value:"quantity"}),e(n,{label:"折扣率",value:"discount"}),e(n,{label:"订单状态",value:"orderStatus"}),e(n,{label:"交付日期",value:"deliveryDate"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(p,{span:12},{default:l(()=>[e(c,{label:"属性值"},{default:l(()=>[e(_,{modelValue:a.value,"onUpdate:modelValue":o=>a.value=o,placeholder:"请输入属性值"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)):a.type==="addProduct"?(i(),v(m,{key:1,gutter:20},{default:l(()=>[e(p,{span:12},{default:l(()=>[e(c,{label:"产品ID"},{default:l(()=>[e(_,{modelValue:a.productId,"onUpdate:modelValue":o=>a.productId=o,placeholder:"请输入产品ID"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(p,{span:12},{default:l(()=>[e(c,{label:"产品数量"},{default:l(()=>[e(I,{modelValue:a.quantity,"onUpdate:modelValue":o=>a.quantity=o,min:1,max:999,step:1,placeholder:"请输入数量"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)):a.type==="removeProduct"?(i(),v(m,{key:2,gutter:20},{default:l(()=>[e(p,{span:24},{default:l(()=>[e(c,{label:"产品ID"},{default:l(()=>[e(_,{modelValue:a.productId,"onUpdate:modelValue":o=>a.productId=o,placeholder:"请输入产品ID"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)):a.type==="showMessage"?(i(),v(m,{key:3,gutter:20},{default:l(()=>[e(p,{span:12},{default:l(()=>[e(c,{label:"消息内容"},{default:l(()=>[e(_,{modelValue:a.message,"onUpdate:modelValue":o=>a.message=o,placeholder:"请输入消息内容"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(p,{span:12},{default:l(()=>[e(c,{label:"消息类型"},{default:l(()=>[e(P,{modelValue:a.messageType,"onUpdate:modelValue":o=>a.messageType=o,placeholder:"请选择消息类型"},{default:l(()=>[e(n,{label:"成功",value:"success"}),e(n,{label:"警告",value:"warning"}),e(n,{label:"信息",value:"info"}),e(n,{label:"错误",value:"error"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)):a.type==="callApi"?(i(),y(D,{key:4},[e(m,{gutter:20},{default:l(()=>[e(p,{span:12},{default:l(()=>[e(c,{label:"API地址"},{default:l(()=>[e(_,{modelValue:a.url,"onUpdate:modelValue":o=>a.url=o,placeholder:"请输入API地址"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(p,{span:12},{default:l(()=>[e(c,{label:"请求方法"},{default:l(()=>[e(P,{modelValue:a.method,"onUpdate:modelValue":o=>a.method=o,placeholder:"请选择请求方法"},{default:l(()=>[e(n,{label:"GET",value:"GET"}),e(n,{label:"POST",value:"POST"}),e(n,{label:"PUT",value:"PUT"}),e(n,{label:"DELETE",value:"DELETE"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024),e(m,{gutter:20},{default:l(()=>[e(p,{span:24},{default:l(()=>[e(c,{label:"请求参数"},{default:l(()=>[e(_,{modelValue:a.params,"onUpdate:modelValue":o=>a.params=o,type:"textarea",placeholder:"请输入请求参数（JSON格式）",rows:4},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)],64)):a.type==="executeScript"?(i(),v(m,{key:5,gutter:20},{default:l(()=>[e(p,{span:24},{default:l(()=>[e(c,{label:"脚本内容"},{default:l(()=>[e(_,{modelValue:a.script,"onUpdate:modelValue":o=>a.script=o,type:"textarea",placeholder:"请输入脚本内容",rows:6},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)):E("",!0),e(m,{gutter:20},{default:l(()=>[e(p,{span:12},{default:l(()=>[e(c,{label:"执行条件"},{default:l(()=>[e(_,{modelValue:a.condition,"onUpdate:modelValue":o=>a.condition=o,placeholder:"请输入执行条件（可选）",rows:2},null,8,["modelValue","onUpdate:modelValue"]),d[4]||(d[4]=s("div",{class:"form-tip"},"示例：quantity > 10",-1))]),_:2,__:[4]},1024)]),_:2},1024),e(p,{span:12},{default:l(()=>[e(c,{label:"执行顺序"},{default:l(()=>[e(I,{modelValue:a.sequence,"onUpdate:modelValue":o=>a.sequence=o,min:1,max:99,step:1,placeholder:"请输入执行顺序"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["model"])])])]),_:1},8,["modelValue"])]),_:1}),e(U,{class:"action-preview",shadow:"hover"},{header:l(()=>d[5]||(d[5]=[s("div",{class:"card-header"},[s("span",null,"动作预览")],-1)])),default:l(()=>[s("div",se,[u.value.length>0?(i(),y("pre",ne,V(F()),1)):(i(),v(x,{key:1,description:"暂无动作预览"}))])]),_:1})])}}},_e=j(ce,[["__scopeId","data-v-89b8d59e"]]);export{_e as default};
