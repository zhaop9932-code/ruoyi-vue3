import{_ as P,r as m,H as v,a as i,c as R,o as r,e as p,b as f,l as x,s as q,w as a,a3 as E,m as l,a4 as M,t as $,k as u,f as y,ab as H,ac as K,y as U,A as I}from"./index-DgigFOm-.js";const j={class:"product-tree"},F={class:"tree-header"},G={class:"tree-node"},J=["title"],O={class:"node-badges"},Q={__name:"ProductTree",props:{bomId:{type:[Number,String],required:!0},treeData:{type:Array,default:()=>[]},configuredNodes:{type:Array,default:()=>[]}},emits:["node-select"],setup(g,{emit:S}){const d=g,V=S,h=m(),b=m(""),N=m([]),T={children:"children",label:"nodeName"},w=e=>({0:I,1:U,2:K})[e.nodeType]||I,z=e=>["node-icon",`node-type-${e.nodeType}`,`status-${e.status}`,{disabled:e.isDisabled,hidden:!e.isVisible}],D=e=>{e.status!=="disabled"&&e.isVisible&&V("node-select",e)},B=e=>{h.value.filter(e)},L=(e,t)=>e?t.nodeName.toLowerCase().includes(e.toLowerCase())||t.nodeCode.toLowerCase().includes(e.toLowerCase()):!0,k=(e,t)=>{const _=new Set(t.map(n=>n.bomStructureId)),c=n=>{n.forEach(o=>{_.has(o.bomStructureId)?o.status="configured":o.status="pending",o.children&&o.children.length>0&&c(o.children)})};c(e)};return v(()=>d.treeData,e=>{e&&e.length>0&&(N.value=[e[0].bomStructureId],k(e,d.configuredNodes))},{immediate:!0,deep:!0}),v(()=>d.configuredNodes,e=>{d.treeData.length>0&&k(d.treeData,e)},{deep:!0}),(e,t)=>{const _=i("el-input"),c=i("el-icon"),n=i("el-tag"),o=i("el-badge"),A=i("el-tree");return r(),R("div",j,[p("div",F,[f(_,{modelValue:b.value,"onUpdate:modelValue":t[0]||(t[0]=C=>b.value=C),placeholder:"搜索节点...","prefix-icon":x(q),clearable:"",onInput:B},null,8,["modelValue","prefix-icon"])]),f(A,{ref_key:"treeRef",ref:h,data:g.treeData,props:T,"node-key":"bomStructureId","default-expanded-keys":N.value,"highlight-current":!0,"filter-node-method":L,onNodeClick:D},{default:a(({node:C,data:s})=>[p("div",G,[f(c,{class:E(z(s))},{default:a(()=>[(r(),l(M(w(s))))]),_:2},1032,["class"]),p("span",{class:"node-label",title:s.nodeName},$(s.nodeName),9,J),p("div",O,[s.isRequired==="1"?(r(),l(n,{key:0,size:"small",type:"danger",effect:"plain"},{default:a(()=>t[1]||(t[1]=[y(" 必选 ")])),_:1,__:[1]})):u("",!0),s.selectionType==="single"?(r(),l(n,{key:1,size:"small",type:"info",effect:"plain"},{default:a(()=>t[2]||(t[2]=[y(" 单选 ")])),_:1,__:[2]})):u("",!0),s.selectionType==="multiple"?(r(),l(n,{key:2,size:"small",type:"info",effect:"plain"},{default:a(()=>t[3]||(t[3]=[y(" 多选 ")])),_:1,__:[3]})):u("",!0),s.status==="error"?(r(),l(o,{key:3,value:"!",type:"danger"})):u("",!0),s.status==="configured"?(r(),l(c,{key:4,class:"status-icon success",size:16},{default:a(()=>[f(x(H))]),_:1})):u("",!0)])])]),_:1},8,["data","default-expanded-keys"])])}}},X=P(Q,[["__scopeId","data-v-0ed3285f"]]);export{X as default};
