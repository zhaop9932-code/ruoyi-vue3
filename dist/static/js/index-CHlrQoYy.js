import{d as ce,T as _e,r as g,$ as ye,aG as ve,a as t,i as E,c as R,o as d,j as c,b as l,a0 as L,l as a,w as n,U as z,F as M,n as Q,m as _,aF as I,f as s,e as j,t as A,aH as be,aI as we,aJ as Ve,aK as ke,aL as Ce,aM as he}from"./index-DgigFOm-.js";const xe={class:"app-container"},Ne={class:"dialog-footer"},Te=ce({name:"Config"}),Ke=Object.assign(Te,{setup(Se){const{proxy:p}=_e(),{sys_yes_no:N}=p.useDict("sys_yes_no"),$=g([]),v=g(!1),T=g(!0),h=g(!0),S=g([]),q=g(!0),F=g(!0),U=g(0),K=g(""),k=g([]),G=ye({form:{},queryParams:{pageNum:1,pageSize:10,configName:void 0,configKey:void 0,configType:void 0},rules:{configName:[{required:!0,message:"参数名称不能为空",trigger:"blur"}],configKey:[{required:!0,message:"参数键名不能为空",trigger:"blur"}],configValue:[{required:!0,message:"参数键值不能为空",trigger:"blur"}]}}),{queryParams:u,form:i,rules:H}=ve(G);function w(){T.value=!0,be(p.addDateRange(u.value,k.value)).then(r=>{$.value=r.rows,U.value=r.total,T.value=!1})}function J(){v.value=!1,D()}function D(){i.value={configId:void 0,configName:void 0,configKey:void 0,configValue:void 0,configType:"Y",remark:void 0},p.resetForm("configRef")}function x(){u.value.pageNum=1,w()}function O(){k.value=[],p.resetForm("queryRef"),x()}function W(r){S.value=r.map(e=>e.configId),q.value=r.length!=1,F.value=!r.length}function X(){D(),v.value=!0,K.value="添加参数"}function P(r){D();const e=r.configId||S.value;we(e).then(b=>{i.value=b.data,v.value=!0,K.value="修改参数"})}function Z(){p.$refs.configRef.validate(r=>{r&&(i.value.configId!=null?Ce(i.value).then(e=>{p.$modal.msgSuccess("修改成功"),v.value=!1,w()}):he(i.value).then(e=>{p.$modal.msgSuccess("新增成功"),v.value=!1,w()}))})}function Y(r){const e=r.configId||S.value;p.$modal.confirm('是否确认删除参数编号为"'+e+'"的数据项？').then(function(){return Ve(e)}).then(()=>{w(),p.$modal.msgSuccess("删除成功")}).catch(()=>{})}function ee(){p.download("system/config/export",{...u.value},`config_${new Date().getTime()}.xlsx`)}function le(){ke().then(()=>{p.$modal.msgSuccess("刷新缓存成功")})}return w(),(r,e)=>{const b=t("el-input"),m=t("el-form-item"),oe=t("el-option"),ne=t("el-select"),ae=t("el-date-picker"),f=t("el-button"),B=t("el-form"),C=t("el-col"),te=t("right-toolbar"),ie=t("el-row"),y=t("el-table-column"),ue=t("dict-tag"),re=t("el-table"),de=t("pagination"),se=t("el-radio"),pe=t("el-radio-group"),fe=t("el-dialog"),V=E("hasPermi"),me=E("loading");return d(),R("div",xe,[c(l(B,{model:a(u),ref:"queryRef",inline:!0,"label-width":"68px"},{default:n(()=>[l(m,{label:"参数名称",prop:"configName"},{default:n(()=>[l(b,{modelValue:a(u).configName,"onUpdate:modelValue":e[0]||(e[0]=o=>a(u).configName=o),placeholder:"请输入参数名称",clearable:"",style:{width:"240px"},onKeyup:z(x,["enter"])},null,8,["modelValue"])]),_:1}),l(m,{label:"参数键名",prop:"configKey"},{default:n(()=>[l(b,{modelValue:a(u).configKey,"onUpdate:modelValue":e[1]||(e[1]=o=>a(u).configKey=o),placeholder:"请输入参数键名",clearable:"",style:{width:"240px"},onKeyup:z(x,["enter"])},null,8,["modelValue"])]),_:1}),l(m,{label:"系统内置",prop:"configType"},{default:n(()=>[l(ne,{modelValue:a(u).configType,"onUpdate:modelValue":e[2]||(e[2]=o=>a(u).configType=o),placeholder:"系统内置",clearable:"",style:{width:"240px"}},{default:n(()=>[(d(!0),R(M,null,Q(a(N),o=>(d(),_(oe,{key:o.value,label:o.label,value:o.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"创建时间",style:{width:"308px"}},{default:n(()=>[l(ae,{modelValue:a(k),"onUpdate:modelValue":e[3]||(e[3]=o=>I(k)?k.value=o:null),"value-format":"YYYY-MM-DD",type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期"},null,8,["modelValue"])]),_:1}),l(m,null,{default:n(()=>[l(f,{type:"primary",icon:"Search",onClick:x},{default:n(()=>e[13]||(e[13]=[s("搜索")])),_:1,__:[13]}),l(f,{icon:"Refresh",onClick:O},{default:n(()=>e[14]||(e[14]=[s("重置")])),_:1,__:[14]})]),_:1})]),_:1},8,["model"]),[[L,a(h)]]),l(ie,{gutter:10,class:"mb8"},{default:n(()=>[l(C,{span:1.5},{default:n(()=>[c((d(),_(f,{type:"primary",plain:"",icon:"Plus",onClick:X},{default:n(()=>e[15]||(e[15]=[s("新增")])),_:1,__:[15]})),[[V,["system:config:add"]]])]),_:1}),l(C,{span:1.5},{default:n(()=>[c((d(),_(f,{type:"success",plain:"",icon:"Edit",disabled:a(q),onClick:P},{default:n(()=>e[16]||(e[16]=[s("修改")])),_:1,__:[16]},8,["disabled"])),[[V,["system:config:edit"]]])]),_:1}),l(C,{span:1.5},{default:n(()=>[c((d(),_(f,{type:"danger",plain:"",icon:"Delete",disabled:a(F),onClick:Y},{default:n(()=>e[17]||(e[17]=[s("删除")])),_:1,__:[17]},8,["disabled"])),[[V,["system:config:remove"]]])]),_:1}),l(C,{span:1.5},{default:n(()=>[c((d(),_(f,{type:"warning",plain:"",icon:"Download",onClick:ee},{default:n(()=>e[18]||(e[18]=[s("导出")])),_:1,__:[18]})),[[V,["system:config:export"]]])]),_:1}),l(C,{span:1.5},{default:n(()=>[c((d(),_(f,{type:"danger",plain:"",icon:"Refresh",onClick:le},{default:n(()=>e[19]||(e[19]=[s("刷新缓存")])),_:1,__:[19]})),[[V,["system:config:remove"]]])]),_:1}),l(te,{showSearch:a(h),"onUpdate:showSearch":e[4]||(e[4]=o=>I(h)?h.value=o:null),onQueryTable:w},null,8,["showSearch"])]),_:1}),c((d(),_(re,{data:a($),onSelectionChange:W},{default:n(()=>[l(y,{type:"selection",width:"55",align:"center"}),l(y,{label:"参数主键",align:"center",prop:"configId"}),l(y,{label:"参数名称",align:"center",prop:"configName","show-overflow-tooltip":!0}),l(y,{label:"参数键名",align:"center",prop:"configKey","show-overflow-tooltip":!0}),l(y,{label:"参数键值",align:"center",prop:"configValue","show-overflow-tooltip":!0}),l(y,{label:"系统内置",align:"center",prop:"configType"},{default:n(o=>[l(ue,{options:a(N),value:o.row.configType},null,8,["options","value"])]),_:1}),l(y,{label:"备注",align:"center",prop:"remark","show-overflow-tooltip":!0}),l(y,{label:"创建时间",align:"center",prop:"createTime",width:"180"},{default:n(o=>[j("span",null,A(r.parseTime(o.row.createTime)),1)]),_:1}),l(y,{label:"操作",align:"center",width:"150","class-name":"small-padding fixed-width"},{default:n(o=>[c((d(),_(f,{link:"",type:"primary",icon:"Edit",onClick:ge=>P(o.row)},{default:n(()=>e[20]||(e[20]=[s("修改")])),_:2,__:[20]},1032,["onClick"])),[[V,["system:config:edit"]]]),c((d(),_(f,{link:"",type:"primary",icon:"Delete",onClick:ge=>Y(o.row)},{default:n(()=>e[21]||(e[21]=[s("删除")])),_:2,__:[21]},1032,["onClick"])),[[V,["system:config:remove"]]])]),_:1})]),_:1},8,["data"])),[[me,a(T)]]),c(l(de,{total:a(U),page:a(u).pageNum,"onUpdate:page":e[5]||(e[5]=o=>a(u).pageNum=o),limit:a(u).pageSize,"onUpdate:limit":e[6]||(e[6]=o=>a(u).pageSize=o),onPagination:w},null,8,["total","page","limit"]),[[L,a(U)>0]]),l(fe,{title:a(K),modelValue:a(v),"onUpdate:modelValue":e[12]||(e[12]=o=>I(v)?v.value=o:null),width:"500px","append-to-body":""},{footer:n(()=>[j("div",Ne,[l(f,{type:"primary",onClick:Z},{default:n(()=>e[22]||(e[22]=[s("确 定")])),_:1,__:[22]}),l(f,{onClick:J},{default:n(()=>e[23]||(e[23]=[s("取 消")])),_:1,__:[23]})])]),default:n(()=>[l(B,{ref:"configRef",model:a(i),rules:a(H),"label-width":"80px"},{default:n(()=>[l(m,{label:"参数名称",prop:"configName"},{default:n(()=>[l(b,{modelValue:a(i).configName,"onUpdate:modelValue":e[7]||(e[7]=o=>a(i).configName=o),placeholder:"请输入参数名称"},null,8,["modelValue"])]),_:1}),l(m,{label:"参数键名",prop:"configKey"},{default:n(()=>[l(b,{modelValue:a(i).configKey,"onUpdate:modelValue":e[8]||(e[8]=o=>a(i).configKey=o),placeholder:"请输入参数键名"},null,8,["modelValue"])]),_:1}),l(m,{label:"参数键值",prop:"configValue"},{default:n(()=>[l(b,{modelValue:a(i).configValue,"onUpdate:modelValue":e[9]||(e[9]=o=>a(i).configValue=o),type:"textarea",placeholder:"请输入参数键值"},null,8,["modelValue"])]),_:1}),l(m,{label:"系统内置",prop:"configType"},{default:n(()=>[l(pe,{modelValue:a(i).configType,"onUpdate:modelValue":e[10]||(e[10]=o=>a(i).configType=o)},{default:n(()=>[(d(!0),R(M,null,Q(a(N),o=>(d(),_(se,{key:o.value,value:o.value},{default:n(()=>[s(A(o.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),l(m,{label:"备注",prop:"remark"},{default:n(()=>[l(b,{modelValue:a(i).remark,"onUpdate:modelValue":e[11]||(e[11]=o=>a(i).remark=o),type:"textarea",placeholder:"请输入内容"},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title","modelValue"])])}}});export{Ke as default};
