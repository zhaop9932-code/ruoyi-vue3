import{_ as Y,z as u,h as r,d as c,e as o,i,k as n,j as t,t as a,l as _,m as h,q as p,K as x,L as k,Y as Z,n as S,aA as $,aB as G,aw as H,ax as J,au as B,E as M,V as T}from"./index-CwdKQqOf.js";import{u as O}from"./configurator-DAu3_4Je.js";import"./bom-DdrUuB8x.js";import"./superBomRuleRelation-Cz_bCmLL.js";import"./rule-nChVW3Ks.js";import"./superBomVariable-gMrvMuGl.js";const Q={class:"configuration-summary"},U={class:"card-header"},W={class:"statistics"},X={class:"stat-item"},tt={class:"stat-value"},et={class:"stat-item success"},st={class:"stat-value"},ot={class:"stat-item danger"},at={class:"stat-value"},nt={class:"stat-item warning"},it={class:"stat-value"},lt={class:"configured-list"},ct={class:"list-header"},rt={class:"item-header"},dt={class:"item-name"},ut={key:0,class:"item-details"},_t={class:"detail-label"},pt={class:"detail-value"},mt={class:"pricing-section"},ft={key:0,class:"price-breakdown"},vt={class:"price-name"},gt={class:"price-detail"},yt={class:"price-total"},ht={key:2,class:"total-price"},xt={class:"price-value"},kt={class:"summary-actions"},bt={__name:"ConfigurationSummary",setup(Ct){const d=O(),m=u(()=>d.configurationSummary),f=u(()=>d.configuredNodes),v=u(()=>d.pricing),z=u(()=>{const s=d.configSession.status;return{draft:"配置中",saved:"已保存",completed:"已完成"}[s]||"未知"}),V=u(()=>{const s=d.configSession.status;return{draft:"info",saved:"warning",completed:"success"}[s]||"info"}),q=s=>({0:B,1:J,2:H})[s.nodeType]||B,A=s=>{const e={...s};return delete e.quantity,delete e.selectedProductId,e},F=s=>s.replace(/([A-Z])/g," $1").trim(),I=s=>s==null?"-":typeof s=="boolean"?s?"是":"否":Array.isArray(s)?s.join(", "):String(s),P=async()=>{try{await M.confirm("确认要重置所有配置吗？此操作不可撤销。","警告",{type:"warning",confirmButtonText:"确认",cancelButtonText:"取消"}),d.resetConfiguration(),T.success("配置已重置")}catch{}},E=async()=>{await d.completeConfiguration()&&M.confirm("配置已完成！您可以：","配置完成",{type:"success",confirmButtonText:"生成报价",cancelButtonText:"保存配置",distinguishCancelAndClose:!0}).then(()=>{T.info("跳转到报价生成...")}).catch(e=>{e==="cancel"&&d.saveConfigSession()})};return(s,e)=>{const y=r("el-tag"),g=r("el-col"),j=r("el-row"),b=r("el-divider"),D=r("el-icon"),K=r("el-scrollbar"),C=r("el-empty"),w=r("el-button"),L=r("el-card");return o(),c("div",Q,[i(L,{class:"summary-card",shadow:"never"},{header:n(()=>[t("div",U,[e[0]||(e[0]=t("span",null,"配置摘要",-1)),i(y,{type:V.value},{default:n(()=>[p(a(z.value),1)]),_:1},8,["type"])])]),default:n(()=>[t("div",W,[i(j,{gutter:12},{default:n(()=>[i(g,{span:12},{default:n(()=>[t("div",X,[t("div",tt,a(m.value.totalNodes),1),e[1]||(e[1]=t("div",{class:"stat-label"},"总节点数",-1))])]),_:1}),i(g,{span:12},{default:n(()=>[t("div",et,[t("div",st,a(m.value.configuredNodes),1),e[2]||(e[2]=t("div",{class:"stat-label"},"已配置",-1))])]),_:1}),i(g,{span:12},{default:n(()=>[t("div",ot,[t("div",at,a(m.value.requiredNodes),1),e[3]||(e[3]=t("div",{class:"stat-label"},"必选项",-1))])]),_:1}),i(g,{span:12},{default:n(()=>[t("div",nt,[t("div",it,a(m.value.errors),1),e[4]||(e[4]=t("div",{class:"stat-label"},"错误",-1))])]),_:1})]),_:1})]),i(b),t("div",lt,[t("div",ct,[e[5]||(e[5]=t("h4",null,"已选配置",-1)),f.value.length>0?(o(),_(y,{key:0,size:"small",type:"success"},{default:n(()=>[p(a(f.value.length)+" 项 ",1)]),_:1})):h("",!0)]),f.value.length>0?(o(),_(K,{key:0,"max-height":"280px"},{default:n(()=>[(o(!0),c(x,null,k(f.value,l=>(o(),c("div",{key:l.bomStructureId,class:"config-item"},[t("div",rt,[i(D,{size:18},{default:n(()=>[(o(),_(Z(q(l))))]),_:2},1024),t("span",dt,a(l.nodeName),1),i(y,{size:"small",type:"info"},{default:n(()=>[p("x"+a(l.quantity),1)]),_:2},1024)]),l.configuration?(o(),c("div",ut,[(o(!0),c(x,null,k(A(l.configuration),(R,N)=>(o(),c("div",{key:N,class:"detail-row"},[t("span",_t,a(F(N))+":",1),t("span",pt,a(I(R)),1)]))),128))])):h("",!0)]))),128))]),_:1})):(o(),_(C,{key:1,description:"暂无配置项","image-size":80}))]),i(b),t("div",mt,[e[7]||(e[7]=t("h4",null,"价格明细",-1)),v.value.breakdown.length>0?(o(),c("div",ft,[(o(!0),c(x,null,k(v.value.breakdown,l=>(o(),c("div",{key:l.nodeId,class:"price-item"},[t("span",vt,a(l.nodeName),1),t("span",gt," ¥"+a(l.unitPrice.toFixed(2))+" × "+a(l.quantity),1),t("span",yt,"¥"+a(l.totalPrice.toFixed(2)),1)]))),128))])):(o(),_(C,{key:1,description:"暂无价格信息","image-size":60})),v.value.totalPrice>0?(o(),c("div",ht,[e[6]||(e[6]=t("span",null,"总价：",-1)),t("span",xt,"¥"+a(v.value.totalPrice.toFixed(2)),1)])):h("",!0)]),t("div",kt,[i(w,{icon:S($),onClick:P},{default:n(()=>e[8]||(e[8]=[p(" 重置配置 ")])),_:1,__:[8]},8,["icon"]),i(w,{type:"primary",icon:S(G),onClick:E},{default:n(()=>e[9]||(e[9]=[p(" 完成配置 ")])),_:1,__:[9]},8,["icon"])])]),_:1})])}}},zt=Y(bt,[["__scopeId","data-v-b629e104"]]);export{zt as default};
