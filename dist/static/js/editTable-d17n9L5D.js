import{b as j,u as q}from"./gen-Czgm9yAw.js";import{o as R}from"./type-DtBgFH_x.js";import S from"./basicInfoForm-DFzn-k09.js";import P from"./genInfoForm-Dc-WgxfR.js";import{d as G,p as M,M as O,r as b,i as Q,aS as H,a as m,m as x,o as g,w as t,b as e,a1 as K,N as s,c as W,F as z,s as J,e as y,t as E,f as N}from"./index-a6CENfl-.js";import"./menu-BWwOmEC4.js";const A={style:{float:"left"}},X={style:{float:"right",color:"#8492a6","font-size":"13px"}},Y={style:{"text-align":"center","margin-left":"-100px","margin-top":"10px"}},Z=G({name:"GenEdit"}),de=Object.assign(Z,{setup(ee){const w=M(),{proxy:f}=O(),V=b("columnInfo"),C=b(document.documentElement.scrollHeight-245+"px"),h=b([]),c=b([]),U=b([]),i=b({});function D(){const d=f.$refs.basicInfo.$refs.basicInfoForm,n=f.$refs.genInfo.$refs.genInfoForm;Promise.all([d,n].map($)).then(r=>{if(r.every(p=>!!p)){const p=Object.assign({},i.value);p.columns=c.value,p.params={treeCode:i.value.treeCode,treeName:i.value.treeName,treeParentCode:i.value.treeParentCode,parentMenuId:i.value.parentMenuId},q(p).then(a=>{f.$modal.msgSuccess(a.msg),a.code===200&&I()})}else f.$modal.msgError("表单校验未通过，请重新检查提交内容")})}function $(d){return new Promise(n=>{d.validate(r=>{n(r)})})}function I(){const d={path:"/tool/gen",query:{t:Date.now(),pageNum:w.query.pageNum}};f.$tab.closeOpenPage(d)}return(()=>{const d=w.params&&w.params.tableId;d&&(j(d).then(n=>{c.value=n.data.rows,i.value=n.data.info,h.value=n.data.tables}),R().then(n=>{U.value=n.data}))})(),Q(()=>{const d=document.querySelector(".el-table__body > tbody");H.create(d,{handle:".allowDrag",onEnd:n=>{const r=c.value.splice(n.oldIndex,1)[0];c.value.splice(n.newIndex,0,r);for(const u in c.value)c.value[u].sort=parseInt(u)+1}})}),(d,n)=>{const r=m("el-tab-pane"),u=m("el-table-column"),p=m("el-input"),a=m("el-option"),v=m("el-select"),_=m("el-checkbox"),k=m("el-table"),B=m("el-tabs"),T=m("el-button"),F=m("el-form"),L=m("el-card");return g(),x(L,null,{default:t(()=>[e(B,{modelValue:s(V),"onUpdate:modelValue":n[0]||(n[0]=l=>K(V)?V.value=l:null)},{default:t(()=>[e(r,{label:"基本信息",name:"basic"},{default:t(()=>[e(s(S),{ref:"basicInfo",info:s(i)},null,8,["info"])]),_:1}),e(r,{label:"字段信息",name:"columnInfo"},{default:t(()=>[e(k,{ref:"dragTable",data:s(c),"row-key":"columnId","max-height":s(C)},{default:t(()=>[e(u,{label:"序号",type:"index","min-width":"5%","class-name":"allowDrag"}),e(u,{label:"字段列名",prop:"columnName","min-width":"10%","show-overflow-tooltip":!0,"class-name":"allowDrag"}),e(u,{label:"字段描述","min-width":"10%"},{default:t(l=>[e(p,{modelValue:l.row.columnComment,"onUpdate:modelValue":o=>l.row.columnComment=o},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"物理类型",prop:"columnType","min-width":"10%","show-overflow-tooltip":!0}),e(u,{label:"Java类型","min-width":"11%"},{default:t(l=>[e(v,{modelValue:l.row.javaType,"onUpdate:modelValue":o=>l.row.javaType=o},{default:t(()=>[e(a,{label:"Long",value:"Long"}),e(a,{label:"String",value:"String"}),e(a,{label:"Integer",value:"Integer"}),e(a,{label:"Double",value:"Double"}),e(a,{label:"BigDecimal",value:"BigDecimal"}),e(a,{label:"Date",value:"Date"}),e(a,{label:"Boolean",value:"Boolean"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"java属性","min-width":"10%"},{default:t(l=>[e(p,{modelValue:l.row.javaField,"onUpdate:modelValue":o=>l.row.javaField=o},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"插入","min-width":"5%"},{default:t(l=>[e(_,{"true-value":"1","false-value":"0",modelValue:l.row.isInsert,"onUpdate:modelValue":o=>l.row.isInsert=o},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"编辑","min-width":"5%"},{default:t(l=>[e(_,{"true-value":"1","false-value":"0",modelValue:l.row.isEdit,"onUpdate:modelValue":o=>l.row.isEdit=o},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"列表","min-width":"5%"},{default:t(l=>[e(_,{"true-value":"1","false-value":"0",modelValue:l.row.isList,"onUpdate:modelValue":o=>l.row.isList=o},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"查询","min-width":"5%"},{default:t(l=>[e(_,{"true-value":"1","false-value":"0",modelValue:l.row.isQuery,"onUpdate:modelValue":o=>l.row.isQuery=o},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"查询方式","min-width":"10%"},{default:t(l=>[e(v,{modelValue:l.row.queryType,"onUpdate:modelValue":o=>l.row.queryType=o},{default:t(()=>[e(a,{label:"=",value:"EQ"}),e(a,{label:"!=",value:"NE"}),e(a,{label:">",value:"GT"}),e(a,{label:">=",value:"GTE"}),e(a,{label:"<",value:"LT"}),e(a,{label:"<=",value:"LTE"}),e(a,{label:"LIKE",value:"LIKE"}),e(a,{label:"BETWEEN",value:"BETWEEN"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"必填","min-width":"5%"},{default:t(l=>[e(_,{"true-value":"1","false-value":"0",modelValue:l.row.isRequired,"onUpdate:modelValue":o=>l.row.isRequired=o},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"显示类型","min-width":"12%"},{default:t(l=>[e(v,{modelValue:l.row.htmlType,"onUpdate:modelValue":o=>l.row.htmlType=o},{default:t(()=>[e(a,{label:"文本框",value:"input"}),e(a,{label:"文本域",value:"textarea"}),e(a,{label:"下拉框",value:"select"}),e(a,{label:"单选框",value:"radio"}),e(a,{label:"复选框",value:"checkbox"}),e(a,{label:"日期控件",value:"datetime"}),e(a,{label:"图片上传",value:"imageUpload"}),e(a,{label:"文件上传",value:"fileUpload"}),e(a,{label:"富文本控件",value:"editor"})]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1}),e(u,{label:"字典类型","min-width":"12%"},{default:t(l=>[e(v,{modelValue:l.row.dictType,"onUpdate:modelValue":o=>l.row.dictType=o,clearable:"",filterable:"",placeholder:"请选择"},{default:t(()=>[(g(!0),W(z,null,J(s(U),o=>(g(),x(a,{key:o.dictType,label:o.dictName,value:o.dictType},{default:t(()=>[y("span",A,E(o.dictName),1),y("span",X,E(o.dictType),1)]),_:2},1032,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:1})]),_:1},8,["data","max-height"])]),_:1}),e(r,{label:"生成信息",name:"genInfo"},{default:t(()=>[e(s(P),{ref:"genInfo",info:s(i),tables:s(h)},null,8,["info","tables"])]),_:1})]),_:1},8,["modelValue"]),e(F,{"label-width":"100px"},{default:t(()=>[y("div",Y,[e(T,{type:"primary",onClick:n[1]||(n[1]=l=>D())},{default:t(()=>n[3]||(n[3]=[N("提交")])),_:1,__:[3]}),e(T,{onClick:n[2]||(n[2]=l=>I())},{default:t(()=>n[4]||(n[4]=[N("返回")])),_:1,__:[4]})])]),_:1})]),_:1})}}});export{de as default};
